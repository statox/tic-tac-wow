import{S as x,i as z,s as V,k as w,l as E,m as S,h as m,n as L,I as k,b,J as B,B as R,K as Y,q as C,a as N,r as I,c as P,G as y,u as Z,L as Oe,f as v,g as K,d as Q,t as g,e as ce,w as U,x as D,y as X,z as W,M as Be,N as ie,O as Pe,H as Ce,P as Ve,Q as Ue}from"../../chunks/index-780d2971.js";import{w as De}from"../../chunks/index-341ca319.js";const ae=t=>{const e=t===1?1:-1,l=[1,1,2,2,3,3].map(n=>n*e);return{player:t,pieces:l,unselectableIndexes:new Set,selectedPiece:null}},fe=t=>{const e=[];for(let n=0;n<3;n++){e.push([]);for(let o=0;o<3;o++)e[e.length-1].push([])}const l={state:{player:1,action:"select1"},grid:e,player1:ae(1),player2:ae(2)};return t!=null&&t.player2Start&&(l.state.player=2),l},H=t=>{const e=t.player1.unselectableIndexes,l=t.player2.unselectableIndexes,n=JSON.parse(JSON.stringify(t));return n.player1.unselectableIndexes=new Set([...e.values()]),n.player2.unselectableIndexes=new Set([...l.values()]),n},T=t=>t.state.player===1?t.player1:t.player2,F=t=>t.state.player===1?t.player2:t.player1,se=(t,e,l)=>{const n=t[l][e];return n.length?n[n.length-1]:null},A=(t,e,l)=>{if(e<0||l<0||e>2||l>2)throw new Error(`Invalid coordinates ${e},${l}`);const n=se(t,e,l);return n===null?null:n>0?1:2},Ie=(t,e,l)=>{if(e<0||l<0||e>2||l>2)throw new Error(`Invalid coordinates ${e},${l}`);const n=se(t,e,l);return n===null?0:Math.abs(n)},O=(t,e,l)=>{const n=A(t,e.x,e.y),o=A(t,l.x,l.y);return n!==null&&n===o},j=t=>{const{grid:e}=t,l=new Set;for(let n=0;n<3;n++)if(O(e,{x:0,y:n},{x:1,y:n})&&O(e,{x:0,y:n},{x:2,y:n})){const o=A(e,0,n);l.add(o)}for(let n=0;n<3;n++)if(O(e,{x:n,y:0},{x:n,y:1})&&O(e,{x:n,y:0},{x:n,y:2})){const o=A(e,n,0);l.add(o)}if(O(e,{x:0,y:0},{x:1,y:1})&&O(e,{x:0,y:0},{x:2,y:2})){const n=A(e,0,0);l.add(n)}if(O(e,{x:0,y:2},{x:1,y:1})&&O(e,{x:0,y:2},{x:2,y:0})){const n=A(e,0,2);l.add(n)}if(l.delete(null),l.size===1){t.state.player=[...l.values()][0],t.state.action="winner";return}if(l.size===2){t.state.player=1,t.state.action="draw";return}},Ae=(t,e,l)=>{if(t.state.player!==e.player||t.state.action!=="select1")throw new Error("invalid_step");if(l>=e.pieces.length||l<0)throw new Error("oob_selection_index");if(e.selectedPiece!==null)throw new Error("previous_selection_in_hand");if(e.unselectableIndexes.has(l))throw new Error("piece_already_used");e.selectedPiece={from:"hand",index:l},t.state.action="select2"},Ge=(t,e,l)=>{if(t.state.player!==e.player||t.state.action!=="select1")throw new Error("invalid_step");const{x:n,y:o}=l;if(n<0||o<0||n>2||o>2)throw new Error(`Invalid coordinates ${n},${o}`);if(e.selectedPiece!==null)throw new Error("previous_selection_in_hand");if(t.grid[o][n].length===0)throw new Error("empty_stack_selection");if(A(t.grid,n,o)!==e.player)throw new Error("opponent_owned_selection");e.selectedPiece={from:"board",position:{x:n,y:o}},t.state.action="select2"},Te=(t,e)=>{if(t.state.action!=="select2")throw new Error("invalid_step");const l=T(t);if(l.selectedPiece===null)throw new Error("no_selection_in_hand");const{x:n,y:o}=e,s=l.selectedPiece.from==="hand"?l.pieces[l.selectedPiece.index]:se(t.grid,l.selectedPiece.position.x,l.selectedPiece.position.y);if(s===null)throw new Error("selected_piece_is_null");if(Ie(t.grid,n,o)>=Math.abs(s))throw new Error("destination_bigger_than_piece");return t.grid[e.y][e.x].push(s),l.selectedPiece.from==="hand"&&l.unselectableIndexes.add(l.selectedPiece.index),l.selectedPiece.from==="board"&&t.grid[l.selectedPiece.position.y][l.selectedPiece.position.x].pop(),l.selectedPiece=null,t.state.action="select1",t.state.player=t.state.player===1?2:1,j(t),0},M=(t,e,l)=>{l.from.from==="hand"?Ae(t,e,l.from.index):Ge(t,e,l.from.position),Te(t,l.to)},Xe=(t,e)=>{const l=[];for(let n=0;n<3;n++)for(let o=0;o<3;o++){const s=Ie(t.grid,o,n);(!s||s<Math.abs(e))&&l.push({x:o,y:n})}return l},$=(t,e)=>We(t,e).reduce((n,o)=>{const s=Re(t,e,o),r=Xe(t,s);for(const i of r)n.push({from:o,to:i});return n},[]),We=(t,e)=>{const l=e.pieces.map((n,o)=>o).filter(n=>!e.unselectableIndexes.has(n)).map(n=>({index:n,from:"hand"}));for(let n=0;n<3;n++)for(let o=0;o<3;o++)A(t.grid,o,n)===e.player&&l.push({from:"board",position:{x:o,y:n}});return l},Re=(t,e,l)=>{if(l.from==="board"){const n=t.grid[l.position.y][l.position.x];return n[n.length-1]}return e.pieces[l.index]},ee=t=>{if(j(t),t.state.action==="winner")return t.state.player===1?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;if(t.state.action==="draw")return Number.MAX_SAFE_INTEGER/2;const e=$(t,t.player1),l=$(t,t.player2);if(e.length===0&&l.length===0)return Number.MAX_SAFE_INTEGER/2;let n=0;const o=A(t.grid,1,1);return o===t.player1.player?n+=2:o===t.player2.player&&(n-=2),[A(t.grid,0,0),A(t.grid,2,0),A(t.grid,0,2),A(t.grid,2,2)].forEach(r=>{r!==null&&(n+=r!==null&&r===1?1:-1)}),n},ue=(t,e,l)=>{let n=0;l.from.from==="board"&&(n+=10);const o=Re(t,e,l.from);return n+=Math.abs(o),l.to.x===1&&l.to.y===1&&(n+=5),(l.to.x===0&&l.to.y===0||l.to.x===2&&l.to.y===0||l.to.x===0&&l.to.y===2||l.to.x===2&&l.to.y===2)&&(n+=3),n},le=(t,e,l,n,o)=>{const s=$(t,e);if(j(t),l===0||!s.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(e.player===1){let c=Number.MIN_SAFE_INTEGER,f;for(const d of s){const a=H(t),_=T(a),u=F(a);M(a,_,d);const h=le(a,u,l-1,n,o);if((c===void 0||h.score>=c)&&(c=h.score,f={score:h.score,move:d}),c>o)break;n=Math.max(n,c)}if(!f)throw new Error("no_minmax_result");return f}let r=Number.MAX_SAFE_INTEGER,i;for(const c of s){const f=H(t),d=T(f),a=F(f);M(f,d,c);const _=le(f,a,l-1,n,o);if((r===void 0||_.score<=r)&&(r=_.score,i={score:_.score,move:c}),r<n)break;o=Math.min(o,r)}if(!i)throw new Error("no_minmax_result");return i},je=(t,e)=>{const l=le(t,e,3,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);if(!l.move)throw new Error("no_move_possible");const n=l.move;M(t,e,n)},oe=(t,e,l,n,o)=>{const s=$(t,e);if(j(t),l===0||!s.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(s.sort((c,f)=>ue(t,e,f)-ue(t,e,c)),e.player===1){let c=Number.MIN_SAFE_INTEGER,f;for(const d of s){const a=H(t),_=T(a),u=F(a);M(a,_,d);const h=oe(a,u,l-1,n,o);if((c===void 0||h.score>=c)&&(c=h.score,f={score:h.score,move:d}),c>o)break;n=Math.max(n,c)}if(!f)throw new Error("no_minmax_result");return f}let r=Number.MAX_SAFE_INTEGER,i;for(const c of s){const f=H(t),d=T(f),a=F(f);M(f,d,c);const _=oe(f,a,l-1,n,o);if((r===void 0||_.score<=r)&&(r=_.score,i={score:_.score,move:c}),r<n)break;o=Math.min(o,r)}if(!i)throw new Error("no_minmax_result");return i},Je=(t,e)=>{const l=oe(t,e,4,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);if(!l.move)throw new Error("no_move_possible");const n=l.move;M(t,e,n)},Le=(t,e)=>{const l=$(t,e);if(!l.length)throw new Error("no_move_possible");const s=[...l.reduce((r,i)=>{const c=H(t),f=e.player===1?c.player1:c.player2;M(c,f,i);const d=ee(c);return r.push({move:i,score:d}),r},[])].sort((r,i)=>e.player===1?i.score-r.score:r.score-i.score)[0].move;M(t,e,s)},re=(t,e,l)=>{const n=$(t,e);if(j(t),l===0||!n.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(e.player===1){let o=Number.MIN_SAFE_INTEGER,s;for(const r of n){const i=H(t),c=T(i),f=F(i);M(i,c,r);const d=re(i,f,l-1);(o===void 0||d.score>=o)&&(o=d.score,s={score:d.score,move:r})}if(!s)throw new Error("no_minmax_result");return s}else{let o=Number.MAX_SAFE_INTEGER,s;for(const r of n){const i=H(t),c=T(i),f=F(i);M(i,c,r);const d=re(i,f,l-1);(o===void 0||d.score<=o)&&(o=d.score,s={score:d.score,move:r})}if(!s)throw new Error("no_minmax_result");return s}},xe=(t,e)=>{const l=re(t,e,2);if(!l.move)throw new Error("no_move_possible");const n=l.move;M(t,e,n)},He=(t,e,l)=>{const n=e.player===1?1:-1,o=$(t,e);if(j(t),l===0||!o.length||["draw","winner"].includes(t.state.action))return{score:ee(t)*n,move:null};let s=Number.MIN_SAFE_INTEGER,r;for(const i of o){const c=H(t),f=T(c),d=F(c);M(c,f,i);const a=He(c,d,l-1);a.score=-a.score,(s===void 0||a.score>=s)&&(s=a.score,r={score:a.score,move:i})}if(!r)throw new Error("no_minmax_result");return r},ze=(t,e)=>{const l=He(t,e,2);if(!l.move)throw new Error("no_move_possible");const n=l.move;M(t,e,n)},Fe=(t,e)=>{const l=$(t,e);if(l.length===0)throw new Error("no_move_possible");const n=Math.floor(Math.random()*l.length),o=l[n];M(t,e,o)},qe=(t,e)=>{const l=$(t,e);if(!l.length)throw new Error("no_move_possible");for(const n of l){const o=H(t),s=e.player===1?o.player1:o.player2;if(M(o,s,n),j(o),o.state.action==="winner"&&o.state.player===e.player){M(t,e,n);return}}Fe(t,e)},ne={random:Fe,win_or_random:qe,euristic:Le,minmax:xe,negamax:ze,alphabeta:je,alphabeta_ordered:Je},Ke={player2Auto:!0,player2Strat:"alphabeta_ordered"},te=De(Ke);function de(t,e,l){const n=t.slice();return n[5]=e[l],n}function _e(t){let e,l=t[5]+"",n,o;return{c(){e=w("div"),n=C(l),o=N(),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=S(e);n=I(r,l),o=P(r),r.forEach(m),this.h()},h(){L(e,"class","piece svelte-950i0e"),k(e,"player1",t[5]>0),k(e,"player2",t[5]<0),k(e,"small-circle",Math.abs(t[5])===1),k(e,"medium-circle",Math.abs(t[5])===2),k(e,"large-circle",Math.abs(t[5])===3)},m(s,r){b(s,e,r),y(e,n),y(e,o)},p(s,r){r&1&&l!==(l=s[5]+"")&&Z(n,l),r&1&&k(e,"player1",s[5]>0),r&1&&k(e,"player2",s[5]<0),r&1&&k(e,"small-circle",Math.abs(s[5])===1),r&1&&k(e,"medium-circle",Math.abs(s[5])===2),r&1&&k(e,"large-circle",Math.abs(s[5])===3)},d(s){s&&m(e)}}}function Qe(t){let e,l,n,o=[...t[0]].reverse(),s=[];for(let r=0;r<o.length;r+=1)s[r]=_e(de(t,o,r));return{c(){e=w("button");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=E(r,"BUTTON",{class:!0});var i=S(e);for(let c=0;c<s.length;c+=1)s[c].l(i);i.forEach(m),this.h()},h(){L(e,"class","cell svelte-950i0e"),k(e,"selected",t[1]),k(e,"disabledHand",t[3]),k(e,"disabledCell",t[2])},m(r,i){b(r,e,i);for(let c=0;c<s.length;c+=1)s[c].m(e,null);l||(n=B(e,"click",t[4]),l=!0)},p(r,[i]){if(i&1){o=[...r[0]].reverse();let c;for(c=0;c<o.length;c+=1){const f=de(r,o,c);s[c]?s[c].p(f,i):(s[c]=_e(f),s[c].c(),s[c].m(e,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=o.length}i&2&&k(e,"selected",r[1]),i&8&&k(e,"disabledHand",r[3]),i&4&&k(e,"disabledCell",r[2])},i:R,o:R,d(r){r&&m(e),Y(s,r),l=!1,n()}}}function Ye(t,e,l){let{pieces:n}=e,{selected:o=!1}=e,{disabledCell:s}=e,{disabledHand:r}=e;function i(c){Oe.call(this,t,c)}return t.$$set=c=>{"pieces"in c&&l(0,n=c.pieces),"selected"in c&&l(1,o=c.selected),"disabledCell"in c&&l(2,s=c.disabledCell),"disabledHand"in c&&l(3,r=c.disabledHand)},[n,o,s,r,i]}class $e extends x{constructor(e){super(),z(this,e,Ye,Qe,V,{pieces:0,selected:1,disabledCell:2,disabledHand:3})}}function he(t,e,l){const n=t.slice();return n[4]=e[l],n[6]=l,n}function pe(t,e,l){const n=t.slice();return n[7]=e[l],n[9]=l,n}function me(t){let e,l;function n(){return t[3](t[9],t[6])}return e=new $e({props:{pieces:t[7],disabled:!1,selected:t[2]({x:t[9],y:t[6]})}}),e.$on("click",n),{c(){U(e.$$.fragment)},l(o){D(e.$$.fragment,o)},m(o,s){X(e,o,s),l=!0},p(o,s){t=o;const r={};s&1&&(r.pieces=t[7]),e.$set(r)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){g(e.$$.fragment,o),l=!1},d(o){W(e,o)}}}function ye(t){let e,l,n=t[4],o=[];for(let r=0;r<n.length;r+=1)o[r]=me(pe(t,n,r));const s=r=>g(o[r],1,1,()=>{o[r]=null});return{c(){for(let r=0;r<o.length;r+=1)o[r].c();e=ce()},l(r){for(let i=0;i<o.length;i+=1)o[i].l(r);e=ce()},m(r,i){for(let c=0;c<o.length;c+=1)o[c].m(r,i);b(r,e,i),l=!0},p(r,i){if(i&7){n=r[4];let c;for(c=0;c<n.length;c+=1){const f=pe(r,n,c);o[c]?(o[c].p(f,i),v(o[c],1)):(o[c]=me(f),o[c].c(),v(o[c],1),o[c].m(e.parentNode,e))}for(K(),c=n.length;c<o.length;c+=1)s(c);Q()}},i(r){if(!l){for(let i=0;i<n.length;i+=1)v(o[i]);l=!0}},o(r){o=o.filter(Boolean);for(let i=0;i<o.length;i+=1)g(o[i]);l=!1},d(r){Y(o,r),r&&m(e)}}}function Ze(t){let e,l,n=JSON.stringify(t[0].state)+"",o,s,r,i,c=t[0].grid,f=[];for(let a=0;a<c.length;a+=1)f[a]=ye(he(t,c,a));const d=a=>g(f[a],1,1,()=>{f[a]=null});return{c(){e=w("div"),l=w("div"),o=C(n),s=N(),r=w("div");for(let a=0;a<f.length;a+=1)f[a].c();this.h()},l(a){e=E(a,"DIV",{class:!0});var _=S(e);l=E(_,"DIV",{});var u=S(l);o=I(u,n),u.forEach(m),s=P(_),r=E(_,"DIV",{class:!0});var h=S(r);for(let p=0;p<f.length;p+=1)f[p].l(h);h.forEach(m),_.forEach(m),this.h()},h(){L(r,"class","overlay svelte-1n6jeyv"),L(e,"class","board svelte-1n6jeyv")},m(a,_){b(a,e,_),y(e,l),y(l,o),y(e,s),y(e,r);for(let u=0;u<f.length;u+=1)f[u].m(r,null);i=!0},p(a,[_]){if((!i||_&1)&&n!==(n=JSON.stringify(a[0].state)+"")&&Z(o,n),_&7){c=a[0].grid;let u;for(u=0;u<c.length;u+=1){const h=he(a,c,u);f[u]?(f[u].p(h,_),v(f[u],1)):(f[u]=ye(h),f[u].c(),v(f[u],1),f[u].m(r,null))}for(K(),u=c.length;u<f.length;u+=1)d(u);Q()}},i(a){if(!i){for(let _=0;_<c.length;_+=1)v(f[_]);i=!0}},o(a){f=f.filter(Boolean);for(let _=0;_<f.length;_+=1)g(f[_]);i=!1},d(a){a&&m(e),Y(f,a)}}}function et(t,e,l){let{game:n}=e,{onSelectCell:o}=e;const s=i=>{for(const c of[n.player1,n.player2]){const{selectedPiece:f}=c;if((f==null?void 0:f.from)==="board"&&f.position.x===i.x&&f.position.y===i.y)return!0}return!1},r=(i,c)=>o({x:i,y:c});return t.$$set=i=>{"game"in i&&l(0,n=i.game),"onSelectCell"in i&&l(1,o=i.onSelectCell)},[n,o,s,r]}class tt extends x{constructor(e){super(),z(this,e,et,Ze,V,{game:0,onSelectCell:1})}}function be(t,e,l){const n=t.slice();return n[3]=e[l],n}function ve(t){let e,l=t[3]+"",n,o;return{c(){e=w("option"),n=C(l),o=N(),this.h()},l(s){e=E(s,"OPTION",{});var r=S(e);n=I(r,l),o=P(r),r.forEach(m),this.h()},h(){e.__value=t[3],e.value=e.__value},m(s,r){b(s,e,r),y(e,n),y(e,o)},p:R,d(s){s&&m(e)}}}function nt(t){let e,l,n=t[0].player2Auto?"Human player 2":"Computer player 2",o,s,r,i,c,f=Object.keys(ne),d=[];for(let a=0;a<f.length;a+=1)d[a]=ve(be(t,f,a));return{c(){e=w("div"),l=w("button"),o=C(n),s=N(),r=w("select");for(let a=0;a<d.length;a+=1)d[a].c();this.h()},l(a){e=E(a,"DIV",{});var _=S(e);l=E(_,"BUTTON",{});var u=S(l);o=I(u,n),u.forEach(m),s=P(_),r=E(_,"SELECT",{});var h=S(r);for(let p=0;p<d.length;p+=1)d[p].l(h);h.forEach(m),_.forEach(m),this.h()},h(){t[0].player2Strat===void 0&&Be(()=>t[2].call(r))},m(a,_){b(a,e,_),y(e,l),y(l,o),y(e,s),y(e,r);for(let u=0;u<d.length;u+=1)d[u].m(r,null);ie(r,t[0].player2Strat),i||(c=[B(l,"click",t[1]),B(r,"change",t[2])],i=!0)},p(a,[_]){if(_&1&&n!==(n=a[0].player2Auto?"Human player 2":"Computer player 2")&&Z(o,n),_&0){f=Object.keys(ne);let u;for(u=0;u<f.length;u+=1){const h=be(a,f,u);d[u]?d[u].p(h,_):(d[u]=ve(h),d[u].c(),d[u].m(r,null))}for(;u<d.length;u+=1)d[u].d(1);d.length=f.length}_&1&&ie(r,a[0].player2Strat)},i:R,o:R,d(a){a&&m(e),Y(d,a),i=!1,Pe(c)}}}function lt(t,e,l){let n;Ce(t,te,r=>l(0,n=r));const o=()=>Ve(te,n.player2Auto=!n.player2Auto,n);function s(){n.player2Strat=Ue(this),te.set(n)}return[n,o,s]}class ot extends x{constructor(e){super(),z(this,e,lt,nt,V,{})}}function we(t,e,l){const n=t.slice();return n[9]=e[l],n[11]=l,n}function Ee(t){let e,l,n,o,s,r,i,c,f,d,a,_,u;return{c(){e=w("button"),l=C("Random"),n=N(),o=w("button"),s=C("Win or random"),r=N(),i=w("button"),c=C("Euristic"),f=N(),d=w("button"),a=C("MinMax")},l(h){e=E(h,"BUTTON",{});var p=S(e);l=I(p,"Random"),p.forEach(m),n=P(h),o=E(h,"BUTTON",{});var G=S(o);s=I(G,"Win or random"),G.forEach(m),r=P(h),i=E(h,"BUTTON",{});var J=S(i);c=I(J,"Euristic"),J.forEach(m),f=P(h),d=E(h,"BUTTON",{});var q=S(d);a=I(q,"MinMax"),q.forEach(m)},m(h,p){b(h,e,p),y(e,l),b(h,n,p),b(h,o,p),y(o,s),b(h,r,p),b(h,i,p),y(i,c),b(h,f,p),b(h,d,p),y(d,a),_||(u=[B(e,"click",t[4]),B(o,"click",t[5]),B(i,"click",t[6]),B(d,"click",t[7])],_=!0)},p:R,d(h){h&&m(e),h&&m(n),h&&m(o),h&&m(r),h&&m(i),h&&m(f),h&&m(d),_=!1,Pe(u)}}}function Se(t){var o;let e,l;function n(){return t[8](t[11])}return e=new $e({props:{disabledHand:t[1],disabledCell:t[0].unselectableIndexes.has(t[11]),pieces:[t[9]],selected:((o=t[0].selectedPiece)==null?void 0:o.from)==="hand"&&t[0].selectedPiece.index===t[11]}}),e.$on("click",n),{c(){U(e.$$.fragment)},l(s){D(e.$$.fragment,s)},m(s,r){X(e,s,r),l=!0},p(s,r){var c;t=s;const i={};r&2&&(i.disabledHand=t[1]),r&1&&(i.disabledCell=t[0].unselectableIndexes.has(t[11])),r&1&&(i.pieces=[t[9]]),r&1&&(i.selected=((c=t[0].selectedPiece)==null?void 0:c.from)==="hand"&&t[0].selectedPiece.index===t[11]),e.$set(i)},i(s){l||(v(e.$$.fragment,s),l=!0)},o(s){g(e.$$.fragment,s),l=!1},d(s){W(e,s)}}}function rt(t){let e,l,n=t[0].player+"",o,s,r,i,c,f=!t[1]&&Ee(t),d=t[0].pieces,a=[];for(let u=0;u<d.length;u+=1)a[u]=Se(we(t,d,u));const _=u=>g(a[u],1,1,()=>{a[u]=null});return{c(){e=w("span"),l=C("Player "),o=C(n),s=N(),f&&f.c(),r=N(),i=w("div");for(let u=0;u<a.length;u+=1)a[u].c();this.h()},l(u){e=E(u,"SPAN",{});var h=S(e);l=I(h,"Player "),o=I(h,n),h.forEach(m),s=P(u),f&&f.l(u),r=P(u),i=E(u,"DIV",{class:!0});var p=S(i);for(let G=0;G<a.length;G+=1)a[G].l(p);p.forEach(m),this.h()},h(){L(i,"class","overlay svelte-rwgxl1")},m(u,h){b(u,e,h),y(e,l),y(e,o),b(u,s,h),f&&f.m(u,h),b(u,r,h),b(u,i,h);for(let p=0;p<a.length;p+=1)a[p].m(i,null);c=!0},p(u,[h]){if((!c||h&1)&&n!==(n=u[0].player+"")&&Z(o,n),u[1]?f&&(f.d(1),f=null):f?f.p(u,h):(f=Ee(u),f.c(),f.m(r.parentNode,r)),h&7){d=u[0].pieces;let p;for(p=0;p<d.length;p+=1){const G=we(u,d,p);a[p]?(a[p].p(G,h),v(a[p],1)):(a[p]=Se(G),a[p].c(),v(a[p],1),a[p].m(i,null))}for(K(),p=d.length;p<a.length;p+=1)_(p);Q()}},i(u){if(!c){for(let h=0;h<d.length;h+=1)v(a[h]);c=!0}},o(u){a=a.filter(Boolean);for(let h=0;h<a.length;h+=1)g(a[h]);c=!1},d(u){u&&m(e),u&&m(s),f&&f.d(u),u&&m(r),u&&m(i),Y(a,u)}}}function st(t,e,l){let{hand:n}=e,{disabled:o}=e,{onSelectPiece:s}=e,{onSelectAuto:r}=e;const i=()=>r(n,"random"),c=()=>r(n,"win_or_random"),f=()=>r(n,"euristic"),d=()=>r(n,"minmax"),a=_=>s(n,_);return t.$$set=_=>{"hand"in _&&l(0,n=_.hand),"disabled"in _&&l(1,o=_.disabled),"onSelectPiece"in _&&l(2,s=_.onSelectPiece),"onSelectAuto"in _&&l(3,r=_.onSelectAuto)},[n,o,s,r,i,c,f,d,a]}class ge extends x{constructor(e){super(),z(this,e,st,rt,V,{hand:0,disabled:1,onSelectPiece:2,onSelectAuto:3})}}function ke(t){let e,l;return e=new tt({props:{onSelectCell:t[1],game:t[0]}}),{c(){U(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){X(e,n,o),l=!0},p(n,o){const s={};o&1&&(s.game=n[0]),e.$set(s)},i(n){l||(v(e.$$.fragment,n),l=!0)},o(n){g(e.$$.fragment,n),l=!1},d(n){W(e,n)}}}function Me(t){let e,l,n,o,s,r,i=t[0].state.player+"",c,f,d,a,_,u;return{c(){e=w("div"),l=w("span"),n=C("Game over!"),o=N(),s=w("span"),r=C("Winner: Player "),c=C(i),f=N(),d=w("button"),a=C("Play again")},l(h){e=E(h,"DIV",{});var p=S(e);l=E(p,"SPAN",{});var G=S(l);n=I(G,"Game over!"),G.forEach(m),o=P(p),s=E(p,"SPAN",{});var J=S(s);r=I(J,"Winner: Player "),c=I(J,i),J.forEach(m),f=P(p),d=E(p,"BUTTON",{});var q=S(d);a=I(q,"Play again"),q.forEach(m),p.forEach(m)},m(h,p){b(h,e,p),y(e,l),y(l,n),y(e,o),y(e,s),y(s,r),y(s,c),y(e,f),y(e,d),y(d,a),_||(u=B(d,"click",t[4]),_=!0)},p(h,p){p&1&&i!==(i=h[0].state.player+"")&&Z(c,i)},d(h){h&&m(e),_=!1,u()}}}function Ne(t){let e,l,n,o;return e=new ge({props:{onSelectAuto:t[3],onSelectPiece:t[2],hand:T(t[0]),disabled:!1}}),n=new ge({props:{onSelectAuto:t[3],onSelectPiece:t[2],hand:F(t[0]),disabled:!0}}),{c(){U(e.$$.fragment),l=N(),U(n.$$.fragment)},l(s){D(e.$$.fragment,s),l=P(s),D(n.$$.fragment,s)},m(s,r){X(e,s,r),b(s,l,r),X(n,s,r),o=!0},p(s,r){const i={};r&1&&(i.hand=T(s[0])),e.$set(i);const c={};r&1&&(c.hand=F(s[0])),n.$set(c)},i(s){o||(v(e.$$.fragment,s),v(n.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),o=!1},d(s){W(e,s),s&&m(l),W(n,s)}}}function ct(t){let e,l,n,o=t[0],s,r,i=t[0],c;l=new ot({});let f=ke(t),d=t[0].state.action==="winner"&&Me(t),a=Ne(t);return{c(){e=w("div"),U(l.$$.fragment),n=N(),f.c(),s=N(),d&&d.c(),r=N(),a.c(),this.h()},l(_){e=E(_,"DIV",{class:!0});var u=S(e);D(l.$$.fragment,u),n=P(u),f.l(u),s=P(u),d&&d.l(u),r=P(u),a.l(u),u.forEach(m),this.h()},h(){L(e,"class","d-flex justify-content-center")},m(_,u){b(_,e,u),X(l,e,null),y(e,n),f.m(e,null),y(e,s),d&&d.m(e,null),y(e,r),a.m(e,null),c=!0},p(_,[u]){u&1&&V(o,o=_[0])?(K(),g(f,1,1,R),Q(),f=ke(_),f.c(),v(f,1),f.m(e,s)):f.p(_,u),_[0].state.action==="winner"?d?d.p(_,u):(d=Me(_),d.c(),d.m(e,r)):d&&(d.d(1),d=null),u&1&&V(i,i=_[0])?(K(),g(a,1,1,R),Q(),a=Ne(_),a.c(),v(a,1),a.m(e,null)):a.p(_,u)},i(_){c||(v(l.$$.fragment,_),v(f),v(a),c=!0)},o(_){g(l.$$.fragment,_),g(f),g(a),c=!1},d(_){_&&m(e),W(l),f.d(_),d&&d.d(),a.d(_)}}}function it(t,e,l){let n;Ce(t,te,d=>l(5,n=d));let o=fe();const s=()=>{if(["winner","select2"].includes(o.state.action)||o.state.player!==o.player2.player||!n.player2Auto)return;const d=ne[n.player2Strat];setTimeout(()=>{d(o,o.player2),l(0,o)},500)};return[o,({x:d,y:a})=>{try{if(o.state.action==="select2"){Te(o,{x:d,y:a})===0&&s(),l(0,o);return}const _=T(o);Ge(o,_,{x:d,y:a}),l(0,o),l(0,o)}catch(_){console.error("Could not select cell"),console.error(_),console.error("Game should be able to keep working")}},(d,a)=>{try{Ae(o,d,a)}catch(_){console.error("Could not select piece"),console.error(_),console.error("Game should be able to keep working")}l(0,o)},(d,a)=>{const _=ne[a];_(o,d),s(),l(0,o)},()=>{l(0,o=fe({player2Start:Math.random()<.5})),o.state.player===2&&n.player2Auto&&s()}]}class at extends x{constructor(e){super(),z(this,e,it,ct,V,{})}}function ft(t){let e,l;return e=new at({}),{c(){U(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){X(e,n,o),l=!0},p:R,i(n){l||(v(e.$$.fragment,n),l=!0)},o(n){g(e.$$.fragment,n),l=!1},d(n){W(e,n)}}}class _t extends x{constructor(e){super(),z(this,e,null,ft,V,{})}}export{_t as default};
