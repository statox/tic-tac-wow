import{S as L,i as z,s as V,k as w,l as E,m as S,h as m,n as J,I as P,b,J as B,B as R,K as Y,q as C,a as M,r as I,c as N,G as y,u as Z,L as He,f as v,g as K,d as Q,t as g,e as ce,w as U,x as D,y as X,z as x,M as Be,N as ie,O as Pe,H as Ce,P as Ve,Q as Ue}from"../../chunks/index-780d2971.js";import{w as De}from"../../chunks/index-341ca319.js";const ae=t=>{const e=t===1?1:-1,o=[1,1,2,2,3,3].map(n=>n*e);return{player:t,pieces:o,unselectableIndexes:new Set,selectedPiece:null}},fe=t=>{const e=[];for(let n=0;n<3;n++){e.push([]);for(let r=0;r<3;r++)e[e.length-1].push([])}const o={state:{player:1,action:"select1"},grid:e,player1:ae(1),player2:ae(2)};return t!=null&&t.player2Start&&(o.state.player=2),o},$=t=>{const e=t.player1.unselectableIndexes,o=t.player2.unselectableIndexes,n=JSON.parse(JSON.stringify(t));return n.player1.unselectableIndexes=new Set([...e.values()]),n.player2.unselectableIndexes=new Set([...o.values()]),n},T=t=>t.state.player===1?t.player1:t.player2,F=t=>t.state.player===1?t.player2:t.player1,se=(t,e,o)=>{const n=t[o][e];return n.length?n[n.length-1]:null},A=(t,e,o)=>{if(e<0||o<0||e>2||o>2)throw new Error(`Invalid coordinates ${e},${o}`);const n=se(t,e,o);return n===null?null:n>0?1:2},Ie=(t,e,o)=>{if(e<0||o<0||e>2||o>2)throw new Error(`Invalid coordinates ${e},${o}`);const n=se(t,e,o);return n===null?0:Math.abs(n)},H=(t,e,o)=>{const n=A(t,e.x,e.y),r=A(t,o.x,o.y);return n!==null&&n===r},W=t=>{const{grid:e}=t,o=new Set;for(let n=0;n<3;n++)if(H(e,{x:0,y:n},{x:1,y:n})&&H(e,{x:0,y:n},{x:2,y:n})){const r=A(e,0,n);o.add(r)}for(let n=0;n<3;n++)if(H(e,{x:n,y:0},{x:n,y:1})&&H(e,{x:n,y:0},{x:n,y:2})){const r=A(e,n,0);o.add(r)}if(H(e,{x:0,y:0},{x:1,y:1})&&H(e,{x:0,y:0},{x:2,y:2})){const n=A(e,0,0);o.add(n)}if(H(e,{x:0,y:2},{x:1,y:1})&&H(e,{x:0,y:2},{x:2,y:0})){const n=A(e,0,2);o.add(n)}if(o.delete(null),o.size===1){t.state.player=[...o.values()][0],t.state.action="winner";return}if(o.size===2){t.state.player=1,t.state.action="draw";return}},Ae=(t,e,o)=>{if(t.state.player!==e.player||t.state.action!=="select1")throw new Error("invalid_step");if(o>=e.pieces.length||o<0)throw new Error("oob_selection_index");if(e.selectedPiece!==null)throw new Error("previous_selection_in_hand");if(e.unselectableIndexes.has(o))throw new Error("piece_already_used");e.selectedPiece={from:"hand",index:o},t.state.action="select2"},Ge=(t,e,o)=>{if(t.state.player!==e.player||t.state.action!=="select1")throw new Error("invalid_step");const{x:n,y:r}=o;if(n<0||r<0||n>2||r>2)throw new Error(`Invalid coordinates ${n},${r}`);if(e.selectedPiece!==null)throw new Error("previous_selection_in_hand");if(t.grid[r][n].length===0)throw new Error("empty_stack_selection");if(A(t.grid,n,r)!==e.player)throw new Error("opponent_owned_selection");e.selectedPiece={from:"board",position:{x:n,y:r}},t.state.action="select2"},Te=(t,e)=>{if(t.state.action!=="select2")throw new Error("invalid_step");const o=T(t);if(o.selectedPiece===null)throw new Error("no_selection_in_hand");const{x:n,y:r}=e,s=o.selectedPiece.from==="hand"?o.pieces[o.selectedPiece.index]:se(t.grid,o.selectedPiece.position.x,o.selectedPiece.position.y);if(s===null)throw new Error("selected_piece_is_null");if(Ie(t.grid,n,r)>=Math.abs(s))throw new Error("destination_bigger_than_piece");return t.grid[e.y][e.x].push(s),o.selectedPiece.from==="hand"&&o.unselectableIndexes.add(o.selectedPiece.index),o.selectedPiece.from==="board"&&t.grid[o.selectedPiece.position.y][o.selectedPiece.position.x].pop(),o.selectedPiece=null,t.state.action="select1",t.state.player=t.state.player===1?2:1,W(t),0},k=(t,e,o)=>{o.from.from==="hand"?Ae(t,e,o.from.index):Ge(t,e,o.from.position),Te(t,o.to)},Xe=(t,e)=>{const o=[];for(let n=0;n<3;n++)for(let r=0;r<3;r++){const s=Ie(t.grid,r,n);(!s||s<Math.abs(e))&&o.push({x:r,y:n})}return o},O=(t,e)=>xe(t,e).reduce((n,r)=>{const s=Re(t,e,r),l=Xe(t,s);for(const c of l)n.push({from:r,to:c});return n},[]),xe=(t,e)=>{const o=e.pieces.map((n,r)=>r).filter(n=>!e.unselectableIndexes.has(n)).map(n=>({index:n,from:"hand"}));for(let n=0;n<3;n++)for(let r=0;r<3;r++)A(t.grid,r,n)===e.player&&o.push({from:"board",position:{x:r,y:n}});return o},Re=(t,e,o)=>{if(o.from==="board"){const n=t.grid[o.position.y][o.position.x];return n[n.length-1]}return e.pieces[o.index]},ee=t=>{if(W(t),t.state.action==="winner")return t.state.player===1?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;if(t.state.action==="draw")return Number.MAX_SAFE_INTEGER/2;const e=O(t,t.player1),o=O(t,t.player2);if(e.length===0&&o.length===0)return Number.MAX_SAFE_INTEGER/2;let n=0;const r=A(t.grid,1,1);return r===t.player1.player?n+=2:r===t.player2.player&&(n-=2),[A(t.grid,0,0),A(t.grid,2,0),A(t.grid,0,2),A(t.grid,2,2)].forEach(l=>{l!==null&&(n+=l!==null&&l===1?1:-1)}),n},ue=(t,e,o)=>{let n=0;o.from.from==="board"&&(n+=10);const r=Re(t,e,o.from);return n+=Math.abs(r),o.to.x===1&&o.to.y===1&&(n+=5),(o.to.x===0&&o.to.y===0||o.to.x===2&&o.to.y===0||o.to.x===0&&o.to.y===2||o.to.x===2&&o.to.y===2)&&(n+=3),n},oe=(t,e,o,n,r)=>{const s=O(t,e);if(W(t),o===0||!s.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(e.player===1){let i=Number.MIN_SAFE_INTEGER,f;for(const d of s){const a=$(t),_=T(a),u=F(a);k(a,_,d);const p=oe(a,u,o-1,n,r);if((i===void 0||p.score>=i)&&(i=p.score,f={score:p.score,move:d}),i>r)break;n=Math.max(n,i)}if(!f)throw new Error("no_minmax_result");return f}let l=Number.MAX_SAFE_INTEGER,c;for(const i of s){const f=$(t),d=T(f),a=F(f);k(f,d,i);const _=oe(f,a,o-1,n,r);if((l===void 0||_.score<=l)&&(l=_.score,c={score:_.score,move:i}),l<n)break;r=Math.min(r,l)}if(!c)throw new Error("no_minmax_result");return c},We=(t,e)=>{const o=oe(t,e,3,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);if(!o.move)throw new Error("no_move_possible");const n=o.move;k(t,e,n)},re=(t,e,o,n,r)=>{const s=O(t,e);if(W(t),o===0||!s.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(s.sort((i,f)=>ue(t,e,f)-ue(t,e,i)),e.player===1){let i=Number.MIN_SAFE_INTEGER,f;for(const d of s){const a=$(t),_=T(a),u=F(a);k(a,_,d);const p=re(a,u,o-1,n,r);if((i===void 0||p.score>=i)&&(i=p.score,f={score:p.score,move:d}),i>r)break;n=Math.max(n,i)}if(!f)throw new Error("no_minmax_result");return f}let l=Number.MAX_SAFE_INTEGER,c;for(const i of s){const f=$(t),d=T(f),a=F(f);k(f,d,i);const _=re(f,a,o-1,n,r);if((l===void 0||_.score<=l)&&(l=_.score,c={score:_.score,move:i}),l<n)break;r=Math.min(r,l)}if(!c)throw new Error("no_minmax_result");return c},je=(t,e)=>{const o=re(t,e,4,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);if(!o.move)throw new Error("no_move_possible");const n=o.move;k(t,e,n)},Je=(t,e)=>{const o=O(t,e);if(!o.length)throw new Error("no_move_possible");const s=[...o.reduce((l,c)=>{const i=$(t),f=e.player===1?i.player1:i.player2;k(i,f,c);const d=ee(i);return l.push({move:c,score:d}),l},[])].sort((l,c)=>e.player===1?c.score-l.score:l.score-c.score)[0].move;k(t,e,s)},le=(t,e,o)=>{const n=O(t,e);if(W(t),o===0||!n.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(e.player===1){let r=Number.MIN_SAFE_INTEGER,s;for(const l of n){const c=$(t),i=T(c),f=F(c);k(c,i,l);const d=le(c,f,o-1);(r===void 0||d.score>=r)&&(r=d.score,s={score:d.score,move:l})}if(!s)throw new Error("no_minmax_result");return s}else{let r=Number.MAX_SAFE_INTEGER,s;for(const l of n){const c=$(t),i=T(c),f=F(c);k(c,i,l);const d=le(c,f,o-1);(r===void 0||d.score<=r)&&(r=d.score,s={score:d.score,move:l})}if(!s)throw new Error("no_minmax_result");return s}},Le=(t,e)=>{const o=le(t,e,2);if(!o.move)throw new Error("no_move_possible");const n=o.move;k(t,e,n)},$e=(t,e,o)=>{const n=e.player===1?1:-1,r=O(t,e);if(W(t),o===0||!r.length||["draw","winner"].includes(t.state.action))return{score:ee(t)*n,move:null};let s=Number.MIN_SAFE_INTEGER,l;for(const c of r){const i=$(t),f=T(i),d=F(i);k(i,f,c);const a=$e(i,d,o-1);a.score=-a.score,(s===void 0||a.score>=s)&&(s=a.score,l={score:a.score,move:c})}if(!l)throw new Error("no_minmax_result");return l},ze=(t,e)=>{const o=$e(t,e,2);if(!o.move)throw new Error("no_move_possible");const n=o.move;k(t,e,n)},Fe=(t,e)=>{const o=O(t,e);if(o.length===0)throw new Error("no_move_possible");const n=Math.floor(Math.random()*o.length),r=o[n];k(t,e,r)},qe=(t,e)=>{const o=O(t,e);if(!o.length)throw new Error("no_move_possible");for(const n of o){const r=$(t),s=e.player===1?r.player1:r.player2;if(k(r,s,n),W(r),r.state.action==="winner"&&r.state.player===e.player){k(t,e,n);return}}Fe(t,e)},ne={random:Fe,win_or_random:qe,euristic:Je,minmax:Le,negamax:ze,alphabeta:We,alphabeta_ordered:je},Ke={player2Auto:!0,player2Strat:"alphabeta_ordered"},te=De(Ke);function de(t,e,o){const n=t.slice();return n[4]=e[o],n}function _e(t){let e,o=t[4]+"",n,r;return{c(){e=w("div"),n=C(o),r=M(),this.h()},l(s){e=E(s,"DIV",{class:!0});var l=S(e);n=I(l,o),r=N(l),l.forEach(m),this.h()},h(){J(e,"class","piece svelte-1bwmfvs"),P(e,"player1",t[4]>0),P(e,"player2",t[4]<0),P(e,"small-circle",Math.abs(t[4])===1),P(e,"medium-circle",Math.abs(t[4])===2),P(e,"large-circle",Math.abs(t[4])===3)},m(s,l){b(s,e,l),y(e,n),y(e,r)},p(s,l){l&1&&o!==(o=s[4]+"")&&Z(n,o),l&1&&P(e,"player1",s[4]>0),l&1&&P(e,"player2",s[4]<0),l&1&&P(e,"small-circle",Math.abs(s[4])===1),l&1&&P(e,"medium-circle",Math.abs(s[4])===2),l&1&&P(e,"large-circle",Math.abs(s[4])===3)},d(s){s&&m(e)}}}function Qe(t){let e,o,n,r=[...t[0]].reverse(),s=[];for(let l=0;l<r.length;l+=1)s[l]=_e(de(t,r,l));return{c(){e=w("button");for(let l=0;l<s.length;l+=1)s[l].c();this.h()},l(l){e=E(l,"BUTTON",{class:!0});var c=S(e);for(let i=0;i<s.length;i+=1)s[i].l(c);c.forEach(m),this.h()},h(){J(e,"class","cell svelte-1bwmfvs"),P(e,"selected",t[1]),P(e,"disabled",t[2])},m(l,c){b(l,e,c);for(let i=0;i<s.length;i+=1)s[i].m(e,null);o||(n=B(e,"click",t[3]),o=!0)},p(l,[c]){if(c&1){r=[...l[0]].reverse();let i;for(i=0;i<r.length;i+=1){const f=de(l,r,i);s[i]?s[i].p(f,c):(s[i]=_e(f),s[i].c(),s[i].m(e,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=r.length}c&2&&P(e,"selected",l[1]),c&4&&P(e,"disabled",l[2])},i:R,o:R,d(l){l&&m(e),Y(s,l),o=!1,n()}}}function Ye(t,e,o){let{pieces:n}=e,{selected:r=!1}=e,{disabled:s}=e;function l(c){He.call(this,t,c)}return t.$$set=c=>{"pieces"in c&&o(0,n=c.pieces),"selected"in c&&o(1,r=c.selected),"disabled"in c&&o(2,s=c.disabled)},[n,r,s,l]}class Oe extends L{constructor(e){super(),z(this,e,Ye,Qe,V,{pieces:0,selected:1,disabled:2})}}function pe(t,e,o){const n=t.slice();return n[4]=e[o],n[6]=o,n}function he(t,e,o){const n=t.slice();return n[7]=e[o],n[9]=o,n}function me(t){let e,o;function n(){return t[3](t[9],t[6])}return e=new Oe({props:{pieces:t[7],disabled:!1,selected:t[2]({x:t[9],y:t[6]})}}),e.$on("click",n),{c(){U(e.$$.fragment)},l(r){D(e.$$.fragment,r)},m(r,s){X(e,r,s),o=!0},p(r,s){t=r;const l={};s&1&&(l.pieces=t[7]),e.$set(l)},i(r){o||(v(e.$$.fragment,r),o=!0)},o(r){g(e.$$.fragment,r),o=!1},d(r){x(e,r)}}}function ye(t){let e,o,n=t[4],r=[];for(let l=0;l<n.length;l+=1)r[l]=me(he(t,n,l));const s=l=>g(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=ce()},l(l){for(let c=0;c<r.length;c+=1)r[c].l(l);e=ce()},m(l,c){for(let i=0;i<r.length;i+=1)r[i].m(l,c);b(l,e,c),o=!0},p(l,c){if(c&7){n=l[4];let i;for(i=0;i<n.length;i+=1){const f=he(l,n,i);r[i]?(r[i].p(f,c),v(r[i],1)):(r[i]=me(f),r[i].c(),v(r[i],1),r[i].m(e.parentNode,e))}for(K(),i=n.length;i<r.length;i+=1)s(i);Q()}},i(l){if(!o){for(let c=0;c<n.length;c+=1)v(r[c]);o=!0}},o(l){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)g(r[c]);o=!1},d(l){Y(r,l),l&&m(e)}}}function Ze(t){let e,o,n=JSON.stringify(t[0].state)+"",r,s,l,c,i=t[0].grid,f=[];for(let a=0;a<i.length;a+=1)f[a]=ye(pe(t,i,a));const d=a=>g(f[a],1,1,()=>{f[a]=null});return{c(){e=w("div"),o=w("div"),r=C(n),s=M(),l=w("div");for(let a=0;a<f.length;a+=1)f[a].c();this.h()},l(a){e=E(a,"DIV",{class:!0});var _=S(e);o=E(_,"DIV",{});var u=S(o);r=I(u,n),u.forEach(m),s=N(_),l=E(_,"DIV",{class:!0});var p=S(l);for(let h=0;h<f.length;h+=1)f[h].l(p);p.forEach(m),_.forEach(m),this.h()},h(){J(l,"class","overlay svelte-1n6jeyv"),J(e,"class","board svelte-1n6jeyv")},m(a,_){b(a,e,_),y(e,o),y(o,r),y(e,s),y(e,l);for(let u=0;u<f.length;u+=1)f[u].m(l,null);c=!0},p(a,[_]){if((!c||_&1)&&n!==(n=JSON.stringify(a[0].state)+"")&&Z(r,n),_&7){i=a[0].grid;let u;for(u=0;u<i.length;u+=1){const p=pe(a,i,u);f[u]?(f[u].p(p,_),v(f[u],1)):(f[u]=ye(p),f[u].c(),v(f[u],1),f[u].m(l,null))}for(K(),u=i.length;u<f.length;u+=1)d(u);Q()}},i(a){if(!c){for(let _=0;_<i.length;_+=1)v(f[_]);c=!0}},o(a){f=f.filter(Boolean);for(let _=0;_<f.length;_+=1)g(f[_]);c=!1},d(a){a&&m(e),Y(f,a)}}}function et(t,e,o){let{game:n}=e,{onSelectCell:r}=e;const s=c=>{for(const i of[n.player1,n.player2]){const{selectedPiece:f}=i;if((f==null?void 0:f.from)==="board"&&f.position.x===c.x&&f.position.y===c.y)return!0}return!1},l=(c,i)=>r({x:c,y:i});return t.$$set=c=>{"game"in c&&o(0,n=c.game),"onSelectCell"in c&&o(1,r=c.onSelectCell)},[n,r,s,l]}class tt extends L{constructor(e){super(),z(this,e,et,Ze,V,{game:0,onSelectCell:1})}}function be(t,e,o){const n=t.slice();return n[3]=e[o],n}function ve(t){let e,o=t[3]+"",n,r;return{c(){e=w("option"),n=C(o),r=M(),this.h()},l(s){e=E(s,"OPTION",{});var l=S(e);n=I(l,o),r=N(l),l.forEach(m),this.h()},h(){e.__value=t[3],e.value=e.__value},m(s,l){b(s,e,l),y(e,n),y(e,r)},p:R,d(s){s&&m(e)}}}function nt(t){let e,o,n=t[0].player2Auto?"Human player 2":"Computer player 2",r,s,l,c,i,f=Object.keys(ne),d=[];for(let a=0;a<f.length;a+=1)d[a]=ve(be(t,f,a));return{c(){e=w("div"),o=w("button"),r=C(n),s=M(),l=w("select");for(let a=0;a<d.length;a+=1)d[a].c();this.h()},l(a){e=E(a,"DIV",{});var _=S(e);o=E(_,"BUTTON",{});var u=S(o);r=I(u,n),u.forEach(m),s=N(_),l=E(_,"SELECT",{});var p=S(l);for(let h=0;h<d.length;h+=1)d[h].l(p);p.forEach(m),_.forEach(m),this.h()},h(){t[0].player2Strat===void 0&&Be(()=>t[2].call(l))},m(a,_){b(a,e,_),y(e,o),y(o,r),y(e,s),y(e,l);for(let u=0;u<d.length;u+=1)d[u].m(l,null);ie(l,t[0].player2Strat),c||(i=[B(o,"click",t[1]),B(l,"change",t[2])],c=!0)},p(a,[_]){if(_&1&&n!==(n=a[0].player2Auto?"Human player 2":"Computer player 2")&&Z(r,n),_&0){f=Object.keys(ne);let u;for(u=0;u<f.length;u+=1){const p=be(a,f,u);d[u]?d[u].p(p,_):(d[u]=ve(p),d[u].c(),d[u].m(l,null))}for(;u<d.length;u+=1)d[u].d(1);d.length=f.length}_&1&&ie(l,a[0].player2Strat)},i:R,o:R,d(a){a&&m(e),Y(d,a),c=!1,Pe(i)}}}function ot(t,e,o){let n;Ce(t,te,l=>o(0,n=l));const r=()=>Ve(te,n.player2Auto=!n.player2Auto,n);function s(){n.player2Strat=Ue(this),te.set(n)}return[n,r,s]}class rt extends L{constructor(e){super(),z(this,e,ot,nt,V,{})}}function we(t,e,o){const n=t.slice();return n[9]=e[o],n[11]=o,n}function Ee(t){let e,o,n,r,s,l,c,i,f,d,a,_,u;return{c(){e=w("button"),o=C("Random"),n=M(),r=w("button"),s=C("Win or random"),l=M(),c=w("button"),i=C("Euristic"),f=M(),d=w("button"),a=C("MinMax")},l(p){e=E(p,"BUTTON",{});var h=S(e);o=I(h,"Random"),h.forEach(m),n=N(p),r=E(p,"BUTTON",{});var G=S(r);s=I(G,"Win or random"),G.forEach(m),l=N(p),c=E(p,"BUTTON",{});var j=S(c);i=I(j,"Euristic"),j.forEach(m),f=N(p),d=E(p,"BUTTON",{});var q=S(d);a=I(q,"MinMax"),q.forEach(m)},m(p,h){b(p,e,h),y(e,o),b(p,n,h),b(p,r,h),y(r,s),b(p,l,h),b(p,c,h),y(c,i),b(p,f,h),b(p,d,h),y(d,a),_||(u=[B(e,"click",t[4]),B(r,"click",t[5]),B(c,"click",t[6]),B(d,"click",t[7])],_=!0)},p:R,d(p){p&&m(e),p&&m(n),p&&m(r),p&&m(l),p&&m(c),p&&m(f),p&&m(d),_=!1,Pe(u)}}}function Se(t){var r;let e,o;function n(){return t[8](t[11])}return e=new Oe({props:{disabled:t[1]||t[0].unselectableIndexes.has(t[11]),pieces:[t[9]],selected:((r=t[0].selectedPiece)==null?void 0:r.from)==="hand"&&t[0].selectedPiece.index===t[11]}}),e.$on("click",n),{c(){U(e.$$.fragment)},l(s){D(e.$$.fragment,s)},m(s,l){X(e,s,l),o=!0},p(s,l){var i;t=s;const c={};l&3&&(c.disabled=t[1]||t[0].unselectableIndexes.has(t[11])),l&1&&(c.pieces=[t[9]]),l&1&&(c.selected=((i=t[0].selectedPiece)==null?void 0:i.from)==="hand"&&t[0].selectedPiece.index===t[11]),e.$set(c)},i(s){o||(v(e.$$.fragment,s),o=!0)},o(s){g(e.$$.fragment,s),o=!1},d(s){x(e,s)}}}function lt(t){let e,o,n=t[0].player+"",r,s,l,c,i,f=!t[1]&&Ee(t),d=t[0].pieces,a=[];for(let u=0;u<d.length;u+=1)a[u]=Se(we(t,d,u));const _=u=>g(a[u],1,1,()=>{a[u]=null});return{c(){e=w("span"),o=C("Player "),r=C(n),s=M(),f&&f.c(),l=M(),c=w("div");for(let u=0;u<a.length;u+=1)a[u].c();this.h()},l(u){e=E(u,"SPAN",{});var p=S(e);o=I(p,"Player "),r=I(p,n),p.forEach(m),s=N(u),f&&f.l(u),l=N(u),c=E(u,"DIV",{class:!0});var h=S(c);for(let G=0;G<a.length;G+=1)a[G].l(h);h.forEach(m),this.h()},h(){J(c,"class","overlay svelte-rwgxl1")},m(u,p){b(u,e,p),y(e,o),y(e,r),b(u,s,p),f&&f.m(u,p),b(u,l,p),b(u,c,p);for(let h=0;h<a.length;h+=1)a[h].m(c,null);i=!0},p(u,[p]){if((!i||p&1)&&n!==(n=u[0].player+"")&&Z(r,n),u[1]?f&&(f.d(1),f=null):f?f.p(u,p):(f=Ee(u),f.c(),f.m(l.parentNode,l)),p&7){d=u[0].pieces;let h;for(h=0;h<d.length;h+=1){const G=we(u,d,h);a[h]?(a[h].p(G,p),v(a[h],1)):(a[h]=Se(G),a[h].c(),v(a[h],1),a[h].m(c,null))}for(K(),h=d.length;h<a.length;h+=1)_(h);Q()}},i(u){if(!i){for(let p=0;p<d.length;p+=1)v(a[p]);i=!0}},o(u){a=a.filter(Boolean);for(let p=0;p<a.length;p+=1)g(a[p]);i=!1},d(u){u&&m(e),u&&m(s),f&&f.d(u),u&&m(l),u&&m(c),Y(a,u)}}}function st(t,e,o){let{hand:n}=e,{disabled:r}=e,{onSelectPiece:s}=e,{onSelectAuto:l}=e;const c=()=>l(n,"random"),i=()=>l(n,"win_or_random"),f=()=>l(n,"euristic"),d=()=>l(n,"minmax"),a=_=>s(n,_);return t.$$set=_=>{"hand"in _&&o(0,n=_.hand),"disabled"in _&&o(1,r=_.disabled),"onSelectPiece"in _&&o(2,s=_.onSelectPiece),"onSelectAuto"in _&&o(3,l=_.onSelectAuto)},[n,r,s,l,c,i,f,d,a]}class ge extends L{constructor(e){super(),z(this,e,st,lt,V,{hand:0,disabled:1,onSelectPiece:2,onSelectAuto:3})}}function ke(t){let e,o;return e=new tt({props:{onSelectCell:t[1],game:t[0]}}),{c(){U(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,r){X(e,n,r),o=!0},p(n,r){const s={};r&1&&(s.game=n[0]),e.$set(s)},i(n){o||(v(e.$$.fragment,n),o=!0)},o(n){g(e.$$.fragment,n),o=!1},d(n){x(e,n)}}}function Me(t){let e,o,n,r,s,l,c=t[0].state.player+"",i,f,d,a,_,u;return{c(){e=w("div"),o=w("span"),n=C("Game over!"),r=M(),s=w("span"),l=C("Winner: Player "),i=C(c),f=M(),d=w("button"),a=C("Play again")},l(p){e=E(p,"DIV",{});var h=S(e);o=E(h,"SPAN",{});var G=S(o);n=I(G,"Game over!"),G.forEach(m),r=N(h),s=E(h,"SPAN",{});var j=S(s);l=I(j,"Winner: Player "),i=I(j,c),j.forEach(m),f=N(h),d=E(h,"BUTTON",{});var q=S(d);a=I(q,"Play again"),q.forEach(m),h.forEach(m)},m(p,h){b(p,e,h),y(e,o),y(o,n),y(e,r),y(e,s),y(s,l),y(s,i),y(e,f),y(e,d),y(d,a),_||(u=B(d,"click",t[4]),_=!0)},p(p,h){h&1&&c!==(c=p[0].state.player+"")&&Z(i,c)},d(p){p&&m(e),_=!1,u()}}}function Ne(t){let e,o,n,r;return e=new ge({props:{onSelectAuto:t[3],onSelectPiece:t[2],hand:T(t[0]),disabled:!1}}),n=new ge({props:{onSelectAuto:t[3],onSelectPiece:t[2],hand:F(t[0]),disabled:!0}}),{c(){U(e.$$.fragment),o=M(),U(n.$$.fragment)},l(s){D(e.$$.fragment,s),o=N(s),D(n.$$.fragment,s)},m(s,l){X(e,s,l),b(s,o,l),X(n,s,l),r=!0},p(s,l){const c={};l&1&&(c.hand=T(s[0])),e.$set(c);const i={};l&1&&(i.hand=F(s[0])),n.$set(i)},i(s){r||(v(e.$$.fragment,s),v(n.$$.fragment,s),r=!0)},o(s){g(e.$$.fragment,s),g(n.$$.fragment,s),r=!1},d(s){x(e,s),s&&m(o),x(n,s)}}}function ct(t){let e,o,n,r=t[0],s,l,c=t[0],i;o=new rt({});let f=ke(t),d=t[0].state.action==="winner"&&Me(t),a=Ne(t);return{c(){e=w("div"),U(o.$$.fragment),n=M(),f.c(),s=M(),d&&d.c(),l=M(),a.c(),this.h()},l(_){e=E(_,"DIV",{class:!0});var u=S(e);D(o.$$.fragment,u),n=N(u),f.l(u),s=N(u),d&&d.l(u),l=N(u),a.l(u),u.forEach(m),this.h()},h(){J(e,"class","d-flex justify-content-center")},m(_,u){b(_,e,u),X(o,e,null),y(e,n),f.m(e,null),y(e,s),d&&d.m(e,null),y(e,l),a.m(e,null),i=!0},p(_,[u]){u&1&&V(r,r=_[0])?(K(),g(f,1,1,R),Q(),f=ke(_),f.c(),v(f,1),f.m(e,s)):f.p(_,u),_[0].state.action==="winner"?d?d.p(_,u):(d=Me(_),d.c(),d.m(e,l)):d&&(d.d(1),d=null),u&1&&V(c,c=_[0])?(K(),g(a,1,1,R),Q(),a=Ne(_),a.c(),v(a,1),a.m(e,null)):a.p(_,u)},i(_){i||(v(o.$$.fragment,_),v(f),v(a),i=!0)},o(_){g(o.$$.fragment,_),g(f),g(a),i=!1},d(_){_&&m(e),x(o),f.d(_),d&&d.d(),a.d(_)}}}function it(t,e,o){let n;Ce(t,te,d=>o(5,n=d));let r=fe();const s=()=>{if(["winner","select2"].includes(r.state.action)||r.state.player!==r.player2.player||!n.player2Auto)return;const d=ne[n.player2Strat];setTimeout(()=>{d(r,r.player2),o(0,r)},500)};return[r,({x:d,y:a})=>{try{if(r.state.action==="select2"){Te(r,{x:d,y:a})===0&&s(),o(0,r);return}const _=T(r);Ge(r,_,{x:d,y:a}),o(0,r),o(0,r)}catch(_){console.error("Could not select cell"),console.error(_),console.error("Game should be able to keep working")}},(d,a)=>{try{Ae(r,d,a)}catch(_){console.error("Could not select piece"),console.error(_),console.error("Game should be able to keep working")}o(0,r)},(d,a)=>{const _=ne[a];_(r,d),s(),o(0,r)},()=>{o(0,r=fe({player2Start:Math.random()<.5})),r.state.player===2&&n.player2Auto&&s()}]}class at extends L{constructor(e){super(),z(this,e,it,ct,V,{})}}function ft(t){let e,o;return e=new at({}),{c(){U(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,r){X(e,n,r),o=!0},p:R,i(n){o||(v(e.$$.fragment,n),o=!0)},o(n){g(e.$$.fragment,n),o=!1},d(n){x(e,n)}}}class _t extends L{constructor(e){super(),z(this,e,null,ft,V,{})}}export{_t as default};
