import{S as H,i as q,s as O,k as g,q as $,a as x,w as X,l as k,m as P,r as I,h as p,c as T,x as Y,b as E,D as d,y as z,f as J,t as j,z as K,H as Q,W as U,u as Z,B as ee}from"../../../chunks/index-1d785069.js";import{P as te}from"../../../chunks/P5-76a6b36f.js";import{w as ne}from"../../../chunks/index-c5a64178.js";function L(t){const{x:e,y:n}=t;if(e<0||e>2||n<0||n>2)throw new Error(`Invalid coords (${e},${n})`);return 8-(3*n+e)}function re(t){if(t<0||t>8)throw new Error("Invalid index ${i}");return{x:2-t%3,y:2-Math.floor(t/3)}}const oe=[448,56,7,292,146,73,273,84],ie=(t,e)=>(t&e)===e;function A(t){let e=t,n=0;for(;e;)n+=e&1,e>>=1;return n}function B(t,e){const n=L(e);return!(t&1<<n)}function D(t,e){const n=L(e);return t+2**n}const R=t=>{for(const e of oe)if(ie(t,e))return!0;return!1};var h=(t=>(t[t.player=1]="player",t[t.computer=2]="computer",t))(h||{});function le(){return{player:0,computer:0}}function N(t){if(!se(t))return"invalid_board";const e=R(t.player),n=R(t.computer);return e&&n?"draw":e?"player_win":n?"computer_win":"not_over"}function b(t,e,n){if(!ae(t,n))throw new Error(`Impossible move. player: ${t==null?void 0:t.player}, computer: ${t==null?void 0:t.computer}, ${JSON.stringify(n)} `);e===h.player?t.player=D(t.player,n):t.computer=D(t.computer,n)}function se(t){if(t.player&t.computer)return!1;const e=A(t.player),n=A(t.computer);return!(Math.abs(e-n)>1)}function ae(t,e){return B(t.player,e)&&B(t.computer,e)}function ce(t){let e=t.player|t.computer;if(e===0)return[0,1,2,3,4,5,6,7,8];if(e===511)return[];const n=[];let r=0;for(;r<9;)e&1||n.push(r),r++,e>>=1;return n}function fe(t,e){const n=t.width/3,r=t.height/3,{height:o,width:s}=t;t.noFill(),t.stroke(255),t.line(n,0,n,o),t.line(n*2,0,n*2,o),t.line(0,r,s,r),t.line(0,r*2,s,r*2);for(let a=0;a<3;a++)for(let l=0;l<3;l++)B(e.player,{x:l,y:a})||(t.stroke("blue"),t.circle(l*n+n/2,a*r+r/2,r/2)),B(e.computer,{x:l,y:a})||(t.stroke("red"),t.line(l*n+n*.3,a*r+r*.3,l*n+n*.7,a*r+r*.7),t.line(l*n+n*.7,a*r+r*.3,l*n+n*.3,a*r+r*.7))}function ue(t){const{mouseX:e,mouseY:n,width:r,height:o}=t,s=Math.floor(t.map(e,0,r,0,3)),a=Math.floor(t.map(n,0,o,0,3));return{x:s,y:a}}function me(t){const e=ce(t);if(e.length===0)throw new Error("No available moves");const n=Math.floor(Math.random()*e.length),r=e[n];return re(r)}function V(t){let e,n;return{c(){e=g("span"),n=$("Player wins!")},l(r){e=k(r,"SPAN",{});var o=P(e);n=I(o,"Player wins!"),o.forEach(p)},m(r,o){E(r,e,o),d(e,n)},d(r){r&&p(e)}}}function W(t){let e,n;return{c(){e=g("span"),n=$("Computer wins!")},l(r){e=k(r,"SPAN",{});var o=P(e);n=I(o,"Computer wins!"),o.forEach(p)},m(r,o){E(r,e,o),d(e,n)},d(r){r&&p(e)}}}function F(t){let e,n;return{c(){e=g("span"),n=$("Draw")},l(r){e=k(r,"SPAN",{});var o=P(e);n=I(o,"Draw"),o.forEach(p)},m(r,o){E(r,e,o),d(e,n)},d(r){r&&p(e)}}}function G(t){let e,n,r,o;return{c(){e=g("span"),n=$("Restarting in "),r=$(t[0]),o=$(" seconds")},l(s){e=k(s,"SPAN",{});var a=P(e);n=I(a,"Restarting in "),r=I(a,t[0]),o=I(a," seconds"),a.forEach(p)},m(s,a){E(s,e,a),d(e,n),d(e,r),d(e,o)},p(s,a){a&1&&Z(r,s[0])},d(s){s&&p(e)}}}function pe(t){let e,n,r,o,s,a,l,_,M,S,v;s=new te({props:{sketch:t[3]}});let u=t[1]==="player_win"&&V(),m=t[1]==="computer_win"&&W(),i=t[1]==="draw"&&F(),f=t[0]>0&&G(t);return{c(){e=g("h2"),n=$("Tic Tac Toe binary"),r=x(),o=g("div"),X(s.$$.fragment),a=x(),l=g("div"),u&&u.c(),_=x(),m&&m.c(),M=x(),i&&i.c(),S=x(),f&&f.c()},l(c){e=k(c,"H2",{});var y=P(e);n=I(y,"Tic Tac Toe binary"),y.forEach(p),r=T(c),o=k(c,"DIV",{});var C=P(o);Y(s.$$.fragment,C),a=T(C),l=k(C,"DIV",{});var w=P(l);u&&u.l(w),_=T(w),m&&m.l(w),M=T(w),i&&i.l(w),S=T(w),f&&f.l(w),w.forEach(p),C.forEach(p)},m(c,y){E(c,e,y),d(e,n),E(c,r,y),E(c,o,y),z(s,o,null),d(o,a),d(o,l),u&&u.m(l,null),d(l,_),m&&m.m(l,null),d(l,M),i&&i.m(l,null),d(l,S),f&&f.m(l,null),v=!0},p(c,[y]){c[1]==="player_win"?u||(u=V(),u.c(),u.m(l,_)):u&&(u.d(1),u=null),c[1]==="computer_win"?m||(m=W(),m.c(),m.m(l,M)):m&&(m.d(1),m=null),c[1]==="draw"?i||(i=F(),i.c(),i.m(l,S)):i&&(i.d(1),i=null),c[0]>0?f?f.p(c,y):(f=G(c),f.c(),f.m(l,null)):f&&(f.d(1),f=null)},i(c){v||(J(s.$$.fragment,c),v=!0)},o(c){j(s.$$.fragment,c),v=!1},d(c){c&&p(e),c&&p(r),c&&p(o),K(s),u&&u.d(),m&&m.d(),i&&i.d(),f&&f.d()}}}function de(t,e,n){let r,o,s,a;const l=ne();Q(t,l,i=>n(1,r=i));let _=0;function M(i){r==="not_over"&&(b(s,h.player,i),l.set(N(s)),v())}function S(){if(r!=="not_over")return;const i=me(s);b(s,h.computer,i),l.set(N(s)),v()}function v(){a=a===h.player?h.computer:h.player}function u(){s=le(),a=h.player,l.set(N(s))}const m=i=>{i.setup=()=>{o=i,i.createCanvas(400,400),u()},i.draw=()=>{i.background(0),fe(i,s)},i.mousePressed=()=>{if(a===h.player){const f=ue(i);M(f),setTimeout(S,500)}}};return l.subscribe(i=>{if(!i||i==="not_over")return;n(0,_=4);const f=setInterval(()=>{n(0,_--,_),_===0&&(u(),clearInterval(f))},1e3)}),U(()=>{o==null||o.remove()}),[_,r,l,m]}class _e extends H{constructor(e){super(),q(this,e,de,pe,O,{})}}function he(t){let e,n;return e=new _e({}),{c(){X(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,o){z(e,r,o),n=!0},p:ee,i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){j(e.$$.fragment,r),n=!1},d(r){K(e,r)}}}class ge extends H{constructor(e){super(),q(this,e,null,he,O,{})}}export{ge as default};
