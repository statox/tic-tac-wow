import{S as x,i as z,s as V,k as w,l as E,m as g,h as m,n as L,I as k,b,J as B,B as R,K as Y,q as C,a as P,r as I,c as N,G as y,u as Z,L as Oe,f as v,g as K,d as Q,t as S,e as ce,w as U,x as D,y as X,z as W,M as Be,N as ie,O as Ne,H as Ce,P as Ve,Q as Ue}from"../../chunks/index-780d2971.js";import{w as De}from"../../chunks/index-341ca319.js";const ae=t=>{const e=t===1?1:-1,l=[1,1,2,2,3,3].map(n=>n*e);return{player:t,pieces:l,unselectableIndexes:new Set,selectedPiece:null}},fe=t=>{const e=[];for(let n=0;n<3;n++){e.push([]);for(let o=0;o<3;o++)e[e.length-1].push([])}const l={state:{player:1,action:"select1"},grid:e,player1:ae(1),player2:ae(2)};return t!=null&&t.player2Start&&(l.state.player=2),l},H=t=>{const e=t.player1.unselectableIndexes,l=t.player2.unselectableIndexes,n=JSON.parse(JSON.stringify(t));return n.player1.unselectableIndexes=new Set([...e.values()]),n.player2.unselectableIndexes=new Set([...l.values()]),n},T=t=>t.state.player===1?t.player1:t.player2,F=t=>t.state.player===1?t.player2:t.player1,se=(t,e,l)=>{const n=t[l][e];return n.length?n[n.length-1]:null},A=(t,e,l)=>{if(e<0||l<0||e>2||l>2)throw new Error(`Invalid coordinates ${e},${l}`);const n=se(t,e,l);return n===null?null:n>0?1:2},Ie=(t,e,l)=>{if(e<0||l<0||e>2||l>2)throw new Error(`Invalid coordinates ${e},${l}`);const n=se(t,e,l);return n===null?0:Math.abs(n)},O=(t,e,l)=>{const n=A(t,e.x,e.y),o=A(t,l.x,l.y);return n!==null&&n===o},j=t=>{const{grid:e}=t,l=new Set;for(let n=0;n<3;n++)if(O(e,{x:0,y:n},{x:1,y:n})&&O(e,{x:0,y:n},{x:2,y:n})){const o=A(e,0,n);l.add(o)}for(let n=0;n<3;n++)if(O(e,{x:n,y:0},{x:n,y:1})&&O(e,{x:n,y:0},{x:n,y:2})){const o=A(e,n,0);l.add(o)}if(O(e,{x:0,y:0},{x:1,y:1})&&O(e,{x:0,y:0},{x:2,y:2})){const n=A(e,0,0);l.add(n)}if(O(e,{x:0,y:2},{x:1,y:1})&&O(e,{x:0,y:2},{x:2,y:0})){const n=A(e,0,2);l.add(n)}if(l.delete(null),l.size===1){t.state.player=[...l.values()][0],t.state.action="winner";return}if(l.size===2){t.state.player=1,t.state.action="draw";return}},Ae=(t,e,l)=>{if(t.state.player!==e.player||t.state.action!=="select1")throw new Error("invalid_step");if(l>=e.pieces.length||l<0)throw new Error("oob_selection_index");if(e.selectedPiece!==null)throw new Error("previous_selection_in_hand");if(e.unselectableIndexes.has(l))throw new Error("piece_already_used");e.selectedPiece={from:"hand",index:l},t.state.action="select2"},Ge=(t,e,l)=>{if(t.state.player!==e.player||t.state.action!=="select1")throw new Error("invalid_step");const{x:n,y:o}=l;if(n<0||o<0||n>2||o>2)throw new Error(`Invalid coordinates ${n},${o}`);if(e.selectedPiece!==null)throw new Error("previous_selection_in_hand");if(t.grid[o][n].length===0)throw new Error("empty_stack_selection");if(A(t.grid,n,o)!==e.player)throw new Error("opponent_owned_selection");e.selectedPiece={from:"board",position:{x:n,y:o}},t.state.action="select2"},Te=(t,e)=>{if(t.state.action!=="select2")throw new Error("invalid_step");const l=T(t);if(l.selectedPiece===null)throw new Error("no_selection_in_hand");const{x:n,y:o}=e,s=l.selectedPiece.from==="hand"?l.pieces[l.selectedPiece.index]:se(t.grid,l.selectedPiece.position.x,l.selectedPiece.position.y);if(s===null)throw new Error("selected_piece_is_null");if(Ie(t.grid,n,o)>=Math.abs(s))throw new Error("destination_bigger_than_piece");return t.grid[e.y][e.x].push(s),l.selectedPiece.from==="hand"&&l.unselectableIndexes.add(l.selectedPiece.index),l.selectedPiece.from==="board"&&t.grid[l.selectedPiece.position.y][l.selectedPiece.position.x].pop(),l.selectedPiece=null,t.state.action="select1",t.state.player=t.state.player===1?2:1,j(t),0},M=(t,e,l)=>{l.from.from==="hand"?Ae(t,e,l.from.index):Ge(t,e,l.from.position),Te(t,l.to)},Xe=(t,e)=>{const l=[];for(let n=0;n<3;n++)for(let o=0;o<3;o++){const s=Ie(t.grid,o,n);(!s||s<Math.abs(e))&&l.push({x:o,y:n})}return l},$=(t,e)=>We(t,e).reduce((n,o)=>{const s=Re(t,e,o),r=Xe(t,s);for(const a of r)n.push({from:o,to:a});return n},[]),We=(t,e)=>{const l=e.pieces.map((n,o)=>o).filter(n=>!e.unselectableIndexes.has(n)).map(n=>({index:n,from:"hand"}));for(let n=0;n<3;n++)for(let o=0;o<3;o++)A(t.grid,o,n)===e.player&&l.push({from:"board",position:{x:o,y:n}});return l},Re=(t,e,l)=>{if(l.from==="board"){const n=t.grid[l.position.y][l.position.x];return n[n.length-1]}return e.pieces[l.index]},ee=t=>{if(j(t),t.state.action==="winner")return t.state.player===1?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;if(t.state.action==="draw")return Number.MAX_SAFE_INTEGER/2;const e=$(t,t.player1),l=$(t,t.player2);if(e.length===0&&l.length===0)return Number.MAX_SAFE_INTEGER/2;let n=0;const o=A(t.grid,1,1);return o===t.player1.player?n+=2:o===t.player2.player&&(n-=2),[A(t.grid,0,0),A(t.grid,2,0),A(t.grid,0,2),A(t.grid,2,2)].forEach(r=>{r!==null&&(n+=r!==null&&r===1?1:-1)}),n},ue=(t,e,l)=>{let n=0;l.from.from==="board"&&(n+=10);const o=Re(t,e,l.from);return n+=Math.abs(o),l.to.x===1&&l.to.y===1&&(n+=5),(l.to.x===0&&l.to.y===0||l.to.x===2&&l.to.y===0||l.to.x===0&&l.to.y===2||l.to.x===2&&l.to.y===2)&&(n+=3),n},le=(t,e,l,n,o)=>{const s=$(t,e);if(j(t),l===0||!s.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(e.player===1){let c=Number.MIN_SAFE_INTEGER,u;for(const _ of s){const i=H(t),d=T(i),f=F(i);M(i,d,_);const h=le(i,f,l-1,n,o);if((c===void 0||h.score>=c)&&(c=h.score,u={score:h.score,move:_}),c>o)break;n=Math.max(n,c)}if(!u)throw new Error("no_minmax_result");return u}let r=Number.MAX_SAFE_INTEGER,a;for(const c of s){const u=H(t),_=T(u),i=F(u);M(u,_,c);const d=le(u,i,l-1,n,o);if((r===void 0||d.score<=r)&&(r=d.score,a={score:d.score,move:c}),r<n)break;o=Math.min(o,r)}if(!a)throw new Error("no_minmax_result");return a},je=(t,e)=>{const l=le(t,e,3,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);if(!l.move)throw new Error("no_move_possible");const n=l.move;M(t,e,n)},oe=(t,e,l,n,o)=>{const s=$(t,e);if(j(t),l===0||!s.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(s.sort((c,u)=>ue(t,e,u)-ue(t,e,c)),e.player===1){let c=Number.MIN_SAFE_INTEGER,u;for(const _ of s){const i=H(t),d=T(i),f=F(i);M(i,d,_);const h=oe(i,f,l-1,n,o);if((c===void 0||h.score>=c)&&(c=h.score,u={score:h.score,move:_}),c>o)break;n=Math.max(n,c)}if(!u)throw new Error("no_minmax_result");return u}let r=Number.MAX_SAFE_INTEGER,a;for(const c of s){const u=H(t),_=T(u),i=F(u);M(u,_,c);const d=oe(u,i,l-1,n,o);if((r===void 0||d.score<=r)&&(r=d.score,a={score:d.score,move:c}),r<n)break;o=Math.min(o,r)}if(!a)throw new Error("no_minmax_result");return a},Je=(t,e)=>{const l=oe(t,e,4,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);if(!l.move)throw new Error("no_move_possible");const n=l.move;M(t,e,n)},Le=(t,e)=>{const l=$(t,e);if(!l.length)throw new Error("no_move_possible");const s=[...l.reduce((r,a)=>{const c=H(t),u=e.player===1?c.player1:c.player2;M(c,u,a);const _=ee(c);return r.push({move:a,score:_}),r},[])].sort((r,a)=>e.player===1?a.score-r.score:r.score-a.score)[0].move;M(t,e,s)},re=(t,e,l)=>{const n=$(t,e);if(j(t),l===0||!n.length||["draw","winner"].includes(t.state.action))return{score:ee(t),move:null};if(e.player===1){let o=Number.MIN_SAFE_INTEGER,s;for(const r of n){const a=H(t),c=T(a),u=F(a);M(a,c,r);const _=re(a,u,l-1);(o===void 0||_.score>=o)&&(o=_.score,s={score:_.score,move:r})}if(!s)throw new Error("no_minmax_result");return s}else{let o=Number.MAX_SAFE_INTEGER,s;for(const r of n){const a=H(t),c=T(a),u=F(a);M(a,c,r);const _=re(a,u,l-1);(o===void 0||_.score<=o)&&(o=_.score,s={score:_.score,move:r})}if(!s)throw new Error("no_minmax_result");return s}},xe=(t,e)=>{const l=re(t,e,2);if(!l.move)throw new Error("no_move_possible");const n=l.move;M(t,e,n)},He=(t,e,l)=>{const n=e.player===1?1:-1,o=$(t,e);if(j(t),l===0||!o.length||["draw","winner"].includes(t.state.action))return{score:ee(t)*n,move:null};let s=Number.MIN_SAFE_INTEGER,r;for(const a of o){const c=H(t),u=T(c),_=F(c);M(c,u,a);const i=He(c,_,l-1);i.score=-i.score,(s===void 0||i.score>=s)&&(s=i.score,r={score:i.score,move:a})}if(!r)throw new Error("no_minmax_result");return r},ze=(t,e)=>{const l=He(t,e,2);if(!l.move)throw new Error("no_move_possible");const n=l.move;M(t,e,n)},Fe=(t,e)=>{const l=$(t,e);if(l.length===0)throw new Error("no_move_possible");const n=Math.floor(Math.random()*l.length),o=l[n];M(t,e,o)},qe=(t,e)=>{const l=$(t,e);if(!l.length)throw new Error("no_move_possible");for(const n of l){const o=H(t),s=e.player===1?o.player1:o.player2;if(M(o,s,n),j(o),o.state.action==="winner"&&o.state.player===e.player){M(t,e,n);return}}Fe(t,e)},ne={random:Fe,win_or_random:qe,euristic:Le,minmax:xe,negamax:ze,alphabeta:je,alphabeta_ordered:Je},Ke={player2Auto:!0,player2Strat:"alphabeta_ordered"},te=De(Ke);function de(t,e,l){const n=t.slice();return n[5]=e[l],n}function _e(t){let e,l=t[5]+"",n,o;return{c(){e=w("div"),n=C(l),o=P(),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=g(e);n=I(r,l),o=N(r),r.forEach(m),this.h()},h(){L(e,"class","piece svelte-950i0e"),k(e,"player1",t[5]>0),k(e,"player2",t[5]<0),k(e,"small-circle",Math.abs(t[5])===1),k(e,"medium-circle",Math.abs(t[5])===2),k(e,"large-circle",Math.abs(t[5])===3)},m(s,r){b(s,e,r),y(e,n),y(e,o)},p(s,r){r&1&&l!==(l=s[5]+"")&&Z(n,l),r&1&&k(e,"player1",s[5]>0),r&1&&k(e,"player2",s[5]<0),r&1&&k(e,"small-circle",Math.abs(s[5])===1),r&1&&k(e,"medium-circle",Math.abs(s[5])===2),r&1&&k(e,"large-circle",Math.abs(s[5])===3)},d(s){s&&m(e)}}}function Qe(t){let e,l,n,o=[...t[0]].reverse(),s=[];for(let r=0;r<o.length;r+=1)s[r]=_e(de(t,o,r));return{c(){e=w("button");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=E(r,"BUTTON",{class:!0});var a=g(e);for(let c=0;c<s.length;c+=1)s[c].l(a);a.forEach(m),this.h()},h(){L(e,"class","cell svelte-950i0e"),k(e,"selected",t[1]),k(e,"disabledHand",t[3]),k(e,"disabledCell",t[2])},m(r,a){b(r,e,a);for(let c=0;c<s.length;c+=1)s[c].m(e,null);l||(n=B(e,"click",t[4]),l=!0)},p(r,[a]){if(a&1){o=[...r[0]].reverse();let c;for(c=0;c<o.length;c+=1){const u=de(r,o,c);s[c]?s[c].p(u,a):(s[c]=_e(u),s[c].c(),s[c].m(e,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=o.length}a&2&&k(e,"selected",r[1]),a&8&&k(e,"disabledHand",r[3]),a&4&&k(e,"disabledCell",r[2])},i:R,o:R,d(r){r&&m(e),Y(s,r),l=!1,n()}}}function Ye(t,e,l){let{pieces:n}=e,{selected:o=!1}=e,{disabledCell:s}=e,{disabledHand:r}=e;function a(c){Oe.call(this,t,c)}return t.$$set=c=>{"pieces"in c&&l(0,n=c.pieces),"selected"in c&&l(1,o=c.selected),"disabledCell"in c&&l(2,s=c.disabledCell),"disabledHand"in c&&l(3,r=c.disabledHand)},[n,o,s,r,a]}class $e extends x{constructor(e){super(),z(this,e,Ye,Qe,V,{pieces:0,selected:1,disabledCell:2,disabledHand:3})}}function he(t,e,l){const n=t.slice();return n[4]=e[l],n[6]=l,n}function pe(t,e,l){const n=t.slice();return n[7]=e[l],n[9]=l,n}function me(t){let e,l;function n(){return t[3](t[9],t[6])}return e=new $e({props:{pieces:t[7],disabled:!1,selected:t[2]({x:t[9],y:t[6]})}}),e.$on("click",n),{c(){U(e.$$.fragment)},l(o){D(e.$$.fragment,o)},m(o,s){X(e,o,s),l=!0},p(o,s){t=o;const r={};s&1&&(r.pieces=t[7]),e.$set(r)},i(o){l||(v(e.$$.fragment,o),l=!0)},o(o){S(e.$$.fragment,o),l=!1},d(o){W(e,o)}}}function ye(t){let e,l,n=t[4],o=[];for(let r=0;r<n.length;r+=1)o[r]=me(pe(t,n,r));const s=r=>S(o[r],1,1,()=>{o[r]=null});return{c(){for(let r=0;r<o.length;r+=1)o[r].c();e=ce()},l(r){for(let a=0;a<o.length;a+=1)o[a].l(r);e=ce()},m(r,a){for(let c=0;c<o.length;c+=1)o[c].m(r,a);b(r,e,a),l=!0},p(r,a){if(a&7){n=r[4];let c;for(c=0;c<n.length;c+=1){const u=pe(r,n,c);o[c]?(o[c].p(u,a),v(o[c],1)):(o[c]=me(u),o[c].c(),v(o[c],1),o[c].m(e.parentNode,e))}for(K(),c=n.length;c<o.length;c+=1)s(c);Q()}},i(r){if(!l){for(let a=0;a<n.length;a+=1)v(o[a]);l=!0}},o(r){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)S(o[a]);l=!1},d(r){Y(o,r),r&&m(e)}}}function Ze(t){let e,l,n=JSON.stringify(t[0].state)+"",o,s,r,a,c=t[0].grid,u=[];for(let i=0;i<c.length;i+=1)u[i]=ye(he(t,c,i));const _=i=>S(u[i],1,1,()=>{u[i]=null});return{c(){e=w("div"),l=w("div"),o=C(n),s=P(),r=w("div");for(let i=0;i<u.length;i+=1)u[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var d=g(e);l=E(d,"DIV",{});var f=g(l);o=I(f,n),f.forEach(m),s=N(d),r=E(d,"DIV",{class:!0});var h=g(r);for(let p=0;p<u.length;p+=1)u[p].l(h);h.forEach(m),d.forEach(m),this.h()},h(){L(r,"class","overlay svelte-1n6jeyv"),L(e,"class","board svelte-1n6jeyv")},m(i,d){b(i,e,d),y(e,l),y(l,o),y(e,s),y(e,r);for(let f=0;f<u.length;f+=1)u[f].m(r,null);a=!0},p(i,[d]){if((!a||d&1)&&n!==(n=JSON.stringify(i[0].state)+"")&&Z(o,n),d&7){c=i[0].grid;let f;for(f=0;f<c.length;f+=1){const h=he(i,c,f);u[f]?(u[f].p(h,d),v(u[f],1)):(u[f]=ye(h),u[f].c(),v(u[f],1),u[f].m(r,null))}for(K(),f=c.length;f<u.length;f+=1)_(f);Q()}},i(i){if(!a){for(let d=0;d<c.length;d+=1)v(u[d]);a=!0}},o(i){u=u.filter(Boolean);for(let d=0;d<u.length;d+=1)S(u[d]);a=!1},d(i){i&&m(e),Y(u,i)}}}function et(t,e,l){let{game:n}=e,{onSelectCell:o}=e;const s=a=>{for(const c of[n.player1,n.player2]){const{selectedPiece:u}=c;if((u==null?void 0:u.from)==="board"&&u.position.x===a.x&&u.position.y===a.y)return!0}return!1},r=(a,c)=>o({x:a,y:c});return t.$$set=a=>{"game"in a&&l(0,n=a.game),"onSelectCell"in a&&l(1,o=a.onSelectCell)},[n,o,s,r]}class tt extends x{constructor(e){super(),z(this,e,et,Ze,V,{game:0,onSelectCell:1})}}function be(t,e,l){const n=t.slice();return n[3]=e[l],n}function ve(t){let e,l=t[3]+"",n,o;return{c(){e=w("option"),n=C(l),o=P(),this.h()},l(s){e=E(s,"OPTION",{});var r=g(e);n=I(r,l),o=N(r),r.forEach(m),this.h()},h(){e.__value=t[3],e.value=e.__value},m(s,r){b(s,e,r),y(e,n),y(e,o)},p:R,d(s){s&&m(e)}}}function nt(t){let e,l,n=t[0].player2Auto?"Human player 2":"Computer player 2",o,s,r,a,c,u=Object.keys(ne),_=[];for(let i=0;i<u.length;i+=1)_[i]=ve(be(t,u,i));return{c(){e=w("div"),l=w("button"),o=C(n),s=P(),r=w("select");for(let i=0;i<_.length;i+=1)_[i].c();this.h()},l(i){e=E(i,"DIV",{});var d=g(e);l=E(d,"BUTTON",{});var f=g(l);o=I(f,n),f.forEach(m),s=N(d),r=E(d,"SELECT",{});var h=g(r);for(let p=0;p<_.length;p+=1)_[p].l(h);h.forEach(m),d.forEach(m),this.h()},h(){t[0].player2Strat===void 0&&Be(()=>t[2].call(r))},m(i,d){b(i,e,d),y(e,l),y(l,o),y(e,s),y(e,r);for(let f=0;f<_.length;f+=1)_[f].m(r,null);ie(r,t[0].player2Strat),a||(c=[B(l,"click",t[1]),B(r,"change",t[2])],a=!0)},p(i,[d]){if(d&1&&n!==(n=i[0].player2Auto?"Human player 2":"Computer player 2")&&Z(o,n),d&0){u=Object.keys(ne);let f;for(f=0;f<u.length;f+=1){const h=be(i,u,f);_[f]?_[f].p(h,d):(_[f]=ve(h),_[f].c(),_[f].m(r,null))}for(;f<_.length;f+=1)_[f].d(1);_.length=u.length}d&1&&ie(r,i[0].player2Strat)},i:R,o:R,d(i){i&&m(e),Y(_,i),a=!1,Ne(c)}}}function lt(t,e,l){let n;Ce(t,te,r=>l(0,n=r));const o=()=>Ve(te,n.player2Auto=!n.player2Auto,n);function s(){n.player2Strat=Ue(this),te.set(n)}return[n,o,s]}class ot extends x{constructor(e){super(),z(this,e,lt,nt,V,{})}}function we(t,e,l){const n=t.slice();return n[9]=e[l],n[11]=l,n}function Ee(t){let e,l,n,o,s,r,a,c,u,_,i,d,f;return{c(){e=w("button"),l=C("Random"),n=P(),o=w("button"),s=C("Win or random"),r=P(),a=w("button"),c=C("Euristic"),u=P(),_=w("button"),i=C("MinMax")},l(h){e=E(h,"BUTTON",{});var p=g(e);l=I(p,"Random"),p.forEach(m),n=N(h),o=E(h,"BUTTON",{});var G=g(o);s=I(G,"Win or random"),G.forEach(m),r=N(h),a=E(h,"BUTTON",{});var J=g(a);c=I(J,"Euristic"),J.forEach(m),u=N(h),_=E(h,"BUTTON",{});var q=g(_);i=I(q,"MinMax"),q.forEach(m)},m(h,p){b(h,e,p),y(e,l),b(h,n,p),b(h,o,p),y(o,s),b(h,r,p),b(h,a,p),y(a,c),b(h,u,p),b(h,_,p),y(_,i),d||(f=[B(e,"click",t[4]),B(o,"click",t[5]),B(a,"click",t[6]),B(_,"click",t[7])],d=!0)},p:R,d(h){h&&m(e),h&&m(n),h&&m(o),h&&m(r),h&&m(a),h&&m(u),h&&m(_),d=!1,Ne(f)}}}function ge(t){var o;let e,l;function n(){return t[8](t[11])}return e=new $e({props:{disabledHand:t[1],disabledCell:t[0].unselectableIndexes.has(t[11]),pieces:[t[9]],selected:((o=t[0].selectedPiece)==null?void 0:o.from)==="hand"&&t[0].selectedPiece.index===t[11]}}),e.$on("click",n),{c(){U(e.$$.fragment)},l(s){D(e.$$.fragment,s)},m(s,r){X(e,s,r),l=!0},p(s,r){var c;t=s;const a={};r&2&&(a.disabledHand=t[1]),r&1&&(a.disabledCell=t[0].unselectableIndexes.has(t[11])),r&1&&(a.pieces=[t[9]]),r&1&&(a.selected=((c=t[0].selectedPiece)==null?void 0:c.from)==="hand"&&t[0].selectedPiece.index===t[11]),e.$set(a)},i(s){l||(v(e.$$.fragment,s),l=!0)},o(s){S(e.$$.fragment,s),l=!1},d(s){W(e,s)}}}function rt(t){let e,l,n=t[0].player+"",o,s,r,a,c,u=!t[1]&&Ee(t),_=t[0].pieces,i=[];for(let f=0;f<_.length;f+=1)i[f]=ge(we(t,_,f));const d=f=>S(i[f],1,1,()=>{i[f]=null});return{c(){e=w("span"),l=C("Player "),o=C(n),s=P(),u&&u.c(),r=P(),a=w("div");for(let f=0;f<i.length;f+=1)i[f].c();this.h()},l(f){e=E(f,"SPAN",{});var h=g(e);l=I(h,"Player "),o=I(h,n),h.forEach(m),s=N(f),u&&u.l(f),r=N(f),a=E(f,"DIV",{class:!0});var p=g(a);for(let G=0;G<i.length;G+=1)i[G].l(p);p.forEach(m),this.h()},h(){L(a,"class","overlay svelte-rwgxl1")},m(f,h){b(f,e,h),y(e,l),y(e,o),b(f,s,h),u&&u.m(f,h),b(f,r,h),b(f,a,h);for(let p=0;p<i.length;p+=1)i[p].m(a,null);c=!0},p(f,[h]){if((!c||h&1)&&n!==(n=f[0].player+"")&&Z(o,n),f[1]?u&&(u.d(1),u=null):u?u.p(f,h):(u=Ee(f),u.c(),u.m(r.parentNode,r)),h&7){_=f[0].pieces;let p;for(p=0;p<_.length;p+=1){const G=we(f,_,p);i[p]?(i[p].p(G,h),v(i[p],1)):(i[p]=ge(G),i[p].c(),v(i[p],1),i[p].m(a,null))}for(K(),p=_.length;p<i.length;p+=1)d(p);Q()}},i(f){if(!c){for(let h=0;h<_.length;h+=1)v(i[h]);c=!0}},o(f){i=i.filter(Boolean);for(let h=0;h<i.length;h+=1)S(i[h]);c=!1},d(f){f&&m(e),f&&m(s),u&&u.d(f),f&&m(r),f&&m(a),Y(i,f)}}}function st(t,e,l){let{hand:n}=e,{disabled:o}=e,{onSelectPiece:s}=e,{onSelectAuto:r}=e;const a=()=>r(n,"random"),c=()=>r(n,"win_or_random"),u=()=>r(n,"euristic"),_=()=>r(n,"minmax"),i=d=>s(n,d);return t.$$set=d=>{"hand"in d&&l(0,n=d.hand),"disabled"in d&&l(1,o=d.disabled),"onSelectPiece"in d&&l(2,s=d.onSelectPiece),"onSelectAuto"in d&&l(3,r=d.onSelectAuto)},[n,o,s,r,a,c,u,_,i]}class Se extends x{constructor(e){super(),z(this,e,st,rt,V,{hand:0,disabled:1,onSelectPiece:2,onSelectAuto:3})}}function ke(t){let e,l;return e=new tt({props:{onSelectCell:t[1],game:t[0]}}),{c(){U(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){X(e,n,o),l=!0},p(n,o){const s={};o&1&&(s.game=n[0]),e.$set(s)},i(n){l||(v(e.$$.fragment,n),l=!0)},o(n){S(e.$$.fragment,n),l=!1},d(n){W(e,n)}}}function Me(t){let e,l,n,o,s,r,a=t[0].state.player+"",c,u,_,i,d,f;return{c(){e=w("div"),l=w("span"),n=C("Game over!"),o=P(),s=w("span"),r=C("Winner: Player "),c=C(a),u=P(),_=w("button"),i=C("Play again")},l(h){e=E(h,"DIV",{});var p=g(e);l=E(p,"SPAN",{});var G=g(l);n=I(G,"Game over!"),G.forEach(m),o=N(p),s=E(p,"SPAN",{});var J=g(s);r=I(J,"Winner: Player "),c=I(J,a),J.forEach(m),u=N(p),_=E(p,"BUTTON",{});var q=g(_);i=I(q,"Play again"),q.forEach(m),p.forEach(m)},m(h,p){b(h,e,p),y(e,l),y(l,n),y(e,o),y(e,s),y(s,r),y(s,c),y(e,u),y(e,_),y(_,i),d||(f=B(_,"click",t[4]),d=!0)},p(h,p){p&1&&a!==(a=h[0].state.player+"")&&Z(c,a)},d(h){h&&m(e),d=!1,f()}}}function Pe(t){let e,l,n,o;return e=new Se({props:{onSelectAuto:t[3],onSelectPiece:t[2],hand:T(t[0]),disabled:!1}}),n=new Se({props:{onSelectAuto:t[3],onSelectPiece:t[2],hand:F(t[0]),disabled:!0}}),{c(){U(e.$$.fragment),l=P(),U(n.$$.fragment)},l(s){D(e.$$.fragment,s),l=N(s),D(n.$$.fragment,s)},m(s,r){X(e,s,r),b(s,l,r),X(n,s,r),o=!0},p(s,r){const a={};r&1&&(a.hand=T(s[0])),e.$set(a);const c={};r&1&&(c.hand=F(s[0])),n.$set(c)},i(s){o||(v(e.$$.fragment,s),v(n.$$.fragment,s),o=!0)},o(s){S(e.$$.fragment,s),S(n.$$.fragment,s),o=!1},d(s){W(e,s),s&&m(l),W(n,s)}}}function ct(t){let e,l,n,o=t[0],s,r,a=t[0],c;l=new ot({});let u=ke(t),_=t[0].state.action==="winner"&&Me(t),i=Pe(t);return{c(){e=w("div"),U(l.$$.fragment),n=P(),u.c(),s=P(),_&&_.c(),r=P(),i.c(),this.h()},l(d){e=E(d,"DIV",{class:!0});var f=g(e);D(l.$$.fragment,f),n=N(f),u.l(f),s=N(f),_&&_.l(f),r=N(f),i.l(f),f.forEach(m),this.h()},h(){L(e,"class","d-flex justify-content-center")},m(d,f){b(d,e,f),X(l,e,null),y(e,n),u.m(e,null),y(e,s),_&&_.m(e,null),y(e,r),i.m(e,null),c=!0},p(d,[f]){f&1&&V(o,o=d[0])?(K(),S(u,1,1,R),Q(),u=ke(d),u.c(),v(u,1),u.m(e,s)):u.p(d,f),d[0].state.action==="winner"?_?_.p(d,f):(_=Me(d),_.c(),_.m(e,r)):_&&(_.d(1),_=null),f&1&&V(a,a=d[0])?(K(),S(i,1,1,R),Q(),i=Pe(d),i.c(),v(i,1),i.m(e,null)):i.p(d,f)},i(d){c||(v(l.$$.fragment,d),v(u),v(i),c=!0)},o(d){S(l.$$.fragment,d),S(u),S(i),c=!1},d(d){d&&m(e),W(l),u.d(d),_&&_.d(),i.d(d)}}}function it(t,e,l){let n;Ce(t,te,i=>l(6,n=i));let o=fe(),s=0;const r=()=>{if(["winner","select2"].includes(o.state.action)||o.state.player!==o.player2.player||!n.player2Auto)return;const i=ne[n.player2Strat];setTimeout(()=>{i(o,o.player2),l(0,o)},500)};return[o,({x:i,y:d})=>{try{if(o.state.action==="select2"){Te(o,{x:i,y:d})===0&&r(),l(0,o);return}const f=T(o);Ge(o,f,{x:i,y:d}),l(0,o),l(0,o)}catch(f){console.error("Could not select cell"),console.error(f),console.error("Game should be able to keep working")}},(i,d)=>{try{Ae(o,i,d)}catch(f){console.error("Could not select piece"),console.error(f),console.error("Game should be able to keep working")}l(0,o)},(i,d)=>{const f=ne[d];f(o,i),r(),l(0,o)},()=>{s++;const i=s%2===1;l(0,o=fe({player2Start:i})),i&&n.player2Auto&&r()}]}class at extends x{constructor(e){super(),z(this,e,it,ct,V,{})}}function ft(t){let e,l;return e=new at({}),{c(){U(e.$$.fragment)},l(n){D(e.$$.fragment,n)},m(n,o){X(e,n,o),l=!0},p:R,i(n){l||(v(e.$$.fragment,n),l=!0)},o(n){S(e.$$.fragment,n),l=!1},d(n){W(e,n)}}}class _t extends x{constructor(e){super(),z(this,e,null,ft,V,{})}}export{_t as default};
